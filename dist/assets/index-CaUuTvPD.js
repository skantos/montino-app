import{r,j as e,a as ee}from"./react-MB1aJdB0.js";import{c as Ae}from"./react-dom-babtui9j.js";import{g as Ee,s as Fe,a as De,b as $e,c as Re}from"./firebase-BOREzNWu.js";import{u as Oe,v as ze,w as qe,x as We,y as He,z as J,A as ne,B as we,D as K,G as W,H as de,I as le,J as ke}from"./@firebase-Bzy7ECXp.js";import{L as k,B as Ge}from"./react-router-dom-BP5qz8hL.js";import{a as se,b as Je,d as Ke,e as q,f as ce}from"./react-router-BDFDsiw1.js";import{T as re,B as Z,D as ie,L as Ve,A as Ue,a as Te,F as je,I as pe,S as ge,M as Q,b as Xe,P as _e,c as fe,d as Pe,e as te,f as A,g as ve,h as be,i as Ne,j as Se}from"./@mui-D6ajMDpQ.js";import{F as H,f as Ie,a as Be,b as ue,c as he,d as Me}from"./@fortawesome-CTlQ_N8p.js";import{f as Le,t as Ye,m as Qe}from"./date-fns-5tFtsWfW.js";import{P as Ze,B as Ce}from"./react-chartjs-2-BMTf87bo.js";import"./chart.js-C_W9Dm9B.js";import"./@babel-DdaQcUjw.js";import"./scheduler-CzFDRTuY.js";import"./tslib-BGVaTf34.js";import"./safevalues-NrgD-8pg.js";import"./idb-Bn1DMRyg.js";import"./@remix-run-BFLWy9pZ.js";import"./react-is-DcfIKM1A.js";import"./clsx-B-dksMZM.js";import"./@emotion-D2LlJvDI.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./prop-types-D-iIXjl8.js";import"./react-transition-group-DD9RWrmj.js";import"./dom-helpers-D0mFdbeO.js";import"./@popperjs-BQBsAJpH.js";import"./@kurkle-BZxJdD1U.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))S(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&S(h)}).observe(document,{childList:!0,subtree:!0});function b(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function S(s){if(s.ep)return;s.ep=!0;const c=b(s);fetch(s.href,c)}})();const ea={apiKey:"AIzaSyAP7Af1h_-zBmBfL_A5K2uuJsJDFuOel0c",authDomain:"local-js-d7712.firebaseapp.com",databaseURL:"https://local-js-d7712-default-rtdb.firebaseio.com",projectId:"local-js-d7712",storageBucket:"local-js-d7712.appspot.com",messagingSenderId:"200538761653",appId:"1:200538761653:web:571a969ac8a572328451fc",measurementId:"G-XXD5WT5TV1"},ae=Oe(ea),Y=Ee(ae),I=ze(ae);qe(ae);We(ae);He(ae);const oe=r.createContext();function aa({children:v}){const[m,b]=r.useState(null),[S,s]=r.useState(null);r.useEffect(()=>{const l=Y.onAuthStateChanged(async p=>{if(p){b(p);const N=J(I,"users",p.uid),g=await ne(N);g.exists()?s(g.data().rolUsuario):s(null)}else b(null),s(null)});return()=>l()},[]);const c=async(l,p)=>{try{const N=await Fe(Y,l,p);b(N.user);const g=J(I,"users",N.user.uid),V=await ne(g);V.exists()?s(V.data().rolUsuario):s(null)}catch(N){throw console.error("Error signing in:",N),N}},h=async()=>{try{await De(Y),b(null),s(null)}catch(l){throw console.error("Error signing out:",l),l}};return e.jsx(oe.Provider,{value:{user:m,role:S,signIn:c,signOut:h},children:v})}function xe(){return r.useContext(oe)}function ta(){const[v,m]=r.useState(""),[b,S]=r.useState(""),[s,c]=r.useState(""),h=se(),{signIn:l,role:p}=xe(),N=async g=>{g.preventDefault(),c("");try{await l(v,b)}catch(V){c("Usuario o contraseña incorrectos"),console.error("Error al iniciar sesión:",V)}};return r.useEffect(()=>{p&&(p==="admin"?h("/ventas"):p==="vendedor"?h("/vendedor/ventas"):c("Rol de usuario no reconocido"))},[p,h]),e.jsx("div",{children:e.jsx("div",{className:"login-box",children:e.jsxs("form",{className:"form",onSubmit:N,children:[e.jsxs("p",{className:"form-title",children:["Los Tios ",e.jsx("br",{}),"Iniciar Sesión"]}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"email",placeholder:"Email",value:v,onChange:g=>m(g.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"password",placeholder:"Contraseña",value:b,onChange:g=>S(g.target.value),required:!0})}),s&&e.jsx("p",{className:"signup-link",children:s}),e.jsx("button",{type:"submit",className:"submit",children:"Ingresar"}),e.jsx("p",{className:"signup-link",children:e.jsx(k,{to:"/resetPassword",className:"resetPassword",children:"Olvidé mi Contraseña"})})]})})})}const ra=()=>{const[v,m]=r.useState(""),[b,S]=r.useState(!1),[s,c]=r.useState(null),h=se(),l=()=>{$e(Y,v).then(()=>{S(!0),setTimeout(()=>{h("/")},6e3)}).catch(p=>{c("No se pudo enviar el correo electrónico de restablecimiento de contraseña.")})};return e.jsxs("div",{className:"recuperar-contrasena",children:[e.jsx("h1",{children:"Recuperar Contraseña"}),b?e.jsx("p",{children:"Se ha enviado un correo electrónico con instrucciones para restablecer tu contraseña."}):e.jsxs(e.Fragment,{children:[e.jsx(re,{type:"email",label:"Correo Electrónico",value:v,onChange:p=>m(p.target.value),sx:{width:"16%"}}),e.jsx(Z,{onClick:l,variant:"outlined",sx:{fontSize:"19px",marginBottom:"19px",top:"10px"},children:"Enviar"}),s&&e.jsx("p",{style:{color:"red"},children:s})]})]})},X=()=>{const v=se(),m=Je(),[b,S]=ee.useState(!1),s=async()=>{const p=Ee();try{await De(p),localStorage.removeItem("token"),v("/")}catch(N){console.error("Error al cerrar sesión:",N)}},c=()=>{S(!b)},h=()=>{S(!1)};ee.useEffect(()=>{const p=()=>{window.innerWidth>=800&&h()};return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}},[]);const l=p=>m.pathname===p?"active":"";return e.jsxs("nav",{className:"navbar",children:[e.jsxs("ul",{className:`sidebar ${b?"visible":""}`,children:[e.jsx("li",{onClick:h,children:e.jsx(k,{className:"menu",to:"#",children:e.jsx(H,{icon:Ie})})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/ventas")}`,to:"/ventas",children:"Venta"})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/agregarProducto")}`,to:"/agregarProducto",children:"Agregar Producto"})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/agregarUsuario")}`,to:"/agregarUsuario",children:"Agregar Usuario"})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/inventario")}`,to:"/inventario",children:"Inventario"})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/devolucion")}`,to:"/devolucion",children:"Devolución"})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/dashboard")}`,to:"/dashboard",children:"Dashboard"})}),e.jsx("li",{children:e.jsx(k,{className:`link ${l("/historial")}`,to:"/historial",children:"Historial"})}),e.jsx("li",{children:e.jsx(k,{className:"link",onClick:s,children:"Cerrar Sesión"})})]}),e.jsxs("ul",{children:[e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/dashboard")}`,to:"/dashboard",children:"Dashboard"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/agregarProducto")}`,to:"/agregarProducto",children:"Agregar Producto"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/agregarUsuario")}`,to:"/agregarUsuario",children:"Agregar Usuario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/devolucion")}`,to:"/devolucion",children:"Devolución"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/ventas")}`,to:"/ventas",children:"Venta"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/inventario")}`,to:"/inventario",children:"Inventario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:`link ${l("/historial")}`,to:"/historial",children:"Historial"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:"link",onClick:s,children:"Cerrar Sesión"})}),e.jsx("li",{onClick:c,children:e.jsx(k,{className:"menu",to:"#",children:e.jsx(H,{icon:Be})})})]})]})},sa=()=>{const[v,m]=r.useState(""),[b,S]=r.useState(""),[s,c]=r.useState(""),[h,l]=r.useState("vendedor"),[p,N]=r.useState(""),[g,V]=r.useState(""),E=async U=>{U.preventDefault(),console.log("Nombre de Usuario:",v),console.log("Email:",b),console.log("Contraseña:",s),console.log("Rol:",h);try{const w=(await Re(Y,b,s)).user;console.log("Usuario creado:",w),await we(J(I,"users",w.uid),{nombreUsuario:v,emailUsuario:b,rolUsuario:h}),V("Usuario registrado exitosamente"),m(""),S(""),c(""),l("vendedor")}catch(B){console.error("Error al registrar el usuario:",B),B.code==="auth/email-already-in-use"?N("El correo electrónico ya está en uso. Por favor, use otro."):B.code==="permission-denied"?N("Permiso denegado. Verifica las reglas de seguridad."):N("Error al registrar el usuario")}};return e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"login-box",children:[e.jsx("p",{className:"form-title",children:"Registrar Usuario"}),e.jsxs("form",{className:"form",onSubmit:E,children:[e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"text",placeholder:"Nombre de Usuario",value:v,onChange:U=>m(U.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"email",placeholder:"Email",value:b,onChange:U=>S(U.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"password",placeholder:"Contraseña",value:s,onChange:U=>c(U.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsxs("select",{value:h,onChange:U=>l(U.target.value),required:!0,children:[e.jsx("option",{value:"vendedor",children:"Vendedor"}),e.jsx("option",{value:"admin",children:"Administrador"})]})}),p&&e.jsx("p",{className:"signup-link",children:p}),g&&e.jsx("p",{className:"signup-link",children:g}),e.jsx("button",{className:"submit",type:"submit",children:"Registrar Usuario"})]})]})]})},oa=()=>{const[v,m]=r.useState(""),[b,S]=r.useState(""),[s,c]=r.useState(""),[h,l]=r.useState(""),[p,N]=r.useState(""),[g,V]=r.useState(""),[E,U]=r.useState(""),[B,w]=r.useState(""),M=async()=>{try{const y=J(I,"productos",v);return(await ne(y)).exists()}catch(y){return console.error("Error checking product existence:",y),U("Error al verificar la existencia del producto"),!1}},L=async y=>{if(y.preventDefault(),await M()){U("El producto ya está registrado");return}try{const F=J(I,"productos",v);await we(F,{idProducto:v,nombreProducto:b,precioProducto:s,categoriaProducto:h,marcaProducto:p,cantidadProducto:g}),w("Producto registrado exitosamente"),m(""),S(""),c(""),l(""),N(""),V(""),U("")}catch(F){U("Hubo un error al registrar el producto"),console.error("Error al registrar el producto:",F)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("div",{children:e.jsxs("div",{className:"productos-box",children:[e.jsx("p",{className:"form-title",children:"Ingresar Producto"}),e.jsxs("form",{className:"form-producto",onSubmit:L,children:[e.jsxs("div",{className:"detalle",children:[e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Código Producto"}),e.jsx("input",{type:"text",placeholder:"Id Producto",value:v,onChange:y=>m(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Nombre producto"}),e.jsx("input",{type:"text",placeholder:"Nombre Producto",value:b,onChange:y=>S(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Precio Producto"}),e.jsx("input",{type:"text",placeholder:"Precio Producto",value:s,onChange:y=>c(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Categoria Producto"}),e.jsx("input",{type:"text",placeholder:"Categoria Producto",value:h,onChange:y=>l(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Marca Producto"}),e.jsx("input",{type:"text",placeholder:"Marca Producto",value:p,onChange:y=>N(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Cantidad Producto"}),e.jsx("input",{type:"text",placeholder:"Cantidad Producto",value:g,onChange:y=>V(y.target.value),required:!0})]})]}),E&&e.jsx("p",{className:"form-title",children:E}),B&&e.jsx("p",{className:"form-title",children:B}),e.jsx("button",{className:"submit",type:"submit",children:"Agregar Producto"})]})]})})]})},na=()=>{const{currentUser:v}=r.useContext(oe),[m,b]=r.useState([]),[S,s]=r.useState(""),[c,h]=r.useState([]),[l,p]=r.useState(!0),[N,g]=r.useState("efectivo"),[V,E]=r.useState(0),[U,B]=r.useState(0),[w,M]=r.useState(""),[L,y]=r.useState(1);r.useEffect(()=>{(async()=>{try{const i=(await K(W(I,"productos"))).docs.map(j=>({id:j.id,...j.data()}));b(i)}catch(a){s("Error al obtener los productos"),console.error("Error al obtener los productos:",a)}finally{p(!1)}})()},[v]),r.useEffect(()=>{if(w.length>0){const t=m.find(a=>String(a.id)===w);t?(F(t,L),M(""),y(1)):(s("Producto no encontrado."),setTimeout(()=>{s(""),M(""),y(1)},3e3))}},[w,m,L]);const O=t=>{M(t.target.value)},F=(t,a)=>{h(i=>{const j=i.find(d=>d.id===t.id);return j?j.cantidad+a<=t.cantidadProducto?i.map(d=>d.id===t.id?{...d,cantidad:d.cantidad+a}:d):(alert("Stock insuficiente"),i):t.cantidadProducto>=a?[...i,{...t,cantidad:a}]:(alert("Stock insuficiente"),i)})},f=t=>{h(a=>{var d;const i=a.find(C=>C.id===t),j=(d=m.find(C=>C.id===t))==null?void 0:d.cantidadProducto;return i&&j>i.cantidad?a.map(C=>C.id===t?{...C,cantidad:C.cantidad+1}:C):(alert("Stock insuficiente"),a)})},D=t=>{h(a=>a.map(i=>i.id===t?{...i,cantidad:Math.max(1,i.cantidad-1)}:i))},n=t=>{h(a=>a.filter(i=>i.id!==t))},u=t=>{g(t.target.value),t.target.value==="efectivo"&&(E(0),B(0))},x=t=>{const a=parseFloat(t.target.value);E(a);const i=c.reduce((j,d)=>j+d.precioProducto*d.cantidad,0);B(a-i)},T=async t=>{t.preventDefault();const a=new Date,i=c.reduce((C,$)=>C+$.precioProducto*$.cantidad,0),j=c.map(C=>({idProducto:C.id,nombreProducto:C.nombreProducto,marcaProducto:C.marcaProducto,categoriaProducto:C.categoriaProducto,precioProducto:C.precioProducto,cantidad:C.cantidad,cantidadProducto:C.cantidadProducto})),d=Y.currentUser;try{await de(W(I,"sales"),{fechaVenta:a,totalVenta:i,tipoPago:N,idUsuario:d.uid,productos:j});const C=le(I);c.forEach($=>{const z=J(I,"productos",$.id);C.update(z,{cantidadProducto:$.cantidadProducto-$.cantidad})}),await C.commit(),h([]),alert("Venta registrada con éxito")}catch(C){s("Error al registrar la venta"),console.error("Error al registrar la venta:",C)}},P=t=>`${t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;c.reduce((t,a)=>t+a.cantidad,0);const o=c.reduce((t,a)=>t+a.precioProducto*a.cantidad,0);return l?e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("h1",{children:"Cargando productos..."})]}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Carrito de compras"}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:w,onChange:O,onBlur:()=>{if(w.length>0){const t=m.find(a=>String(a.id)===w);t?(F(t),M("")):s("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:L,min:"1",onChange:t=>{const a=parseInt(t.target.value);y(a<1?1:a)}})]}),e.jsx("label",{className:"textp",htmlFor:"tipoPago",children:"Tipo de pago:"}),e.jsxs("select",{id:"tipoPago",value:N,onChange:u,className:"carrito-input",children:[e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"tarjeta",children:"Tarjeta"})]}),S&&e.jsx("p",{className:"error",children:S}),e.jsx("section",{className:"tabla-ventas",children:e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"}),e.jsx("th",{className:"carrito-th",children:"Acciones"})]})}),e.jsx("tbody",{className:"carrito-items",children:c.map(t=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:t.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",P(t.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>D(t.idProducto),children:e.jsx(H,{icon:ue})}),t.cantidad,e.jsx("button",{className:"boton-suma",onClick:()=>f(t.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",P(t.precioProducto*t.cantidad)]})}),e.jsx("td",{className:"carrito-td",children:e.jsx("button",{className:"boton-eliminar",onClick:()=>n(t.idProducto),children:e.jsx(H,{icon:Me})})})]},t.idProducto))})]})}),e.jsxs("div",{className:"pago",children:[e.jsxs("p",{className:"textp",children:["Total monto: $",P(o)]}),N==="efectivo"&&e.jsxs("div",{children:[e.jsx("label",{className:"textp",htmlFor:"cantidadEntregada",children:"Cantidad entregada:"}),e.jsx("input",{id:"cantidadEntregada",type:"number",value:V,onChange:x,className:"carrito-input"}),e.jsxs("p",{className:"textp",children:["Vuelto: $",P(U)]})]})]}),e.jsx("button",{className:"boton-venta",onClick:T,children:e.jsx("span",{children:"Finalizar Venta"})})]})})]})},ca=()=>{const[v,m]=r.useState([]),[b,S]=r.useState(""),[s,c]=r.useState([]),[h,l]=r.useState(!0),[p,N]=r.useState(!1),[g,V]=r.useState(null),[E,U]=r.useState({idProducto:"",nombreProducto:"",precioProducto:"",categoriaProducto:"",marcaProducto:"",cantidadProducto:""});r.useEffect(()=>{(async()=>{try{const n=(await K(W(I,"productos"))).docs.map(u=>({idProducto:u.id,...u.data()}));m(n),c(n)}catch{S("Error al cargar los productos. Intente más tarde.")}finally{l(!1)}})()},[]);const B=f=>{const D=f.target.value.toLowerCase();if(D==="")c(v);else{const n=v.filter(u=>{const x=String(u.idProducto).toLowerCase(),T=String(u.nombreProducto).toLowerCase(),P=String(u.precioProducto).toLowerCase(),o=String(u.categoriaProducto).toLowerCase(),t=String(u.marcaProducto).toLowerCase(),a=String(u.cantidadProducto).toLowerCase();return x.includes(D)||T.includes(D)||P.includes(D)||o.includes(D)||t.includes(D)||a.includes(D)});c(n)}},w=f=>`${f.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`,M=f=>{V(f),U({idProducto:f.idProducto,nombreProducto:f.nombreProducto,precioProducto:f.precioProducto,categoriaProducto:f.categoriaProducto,marcaProducto:f.marcaProducto,cantidadProducto:f.cantidadProducto}),N(!0)},L=f=>{const{name:D,value:n}=f.target;U({...E,[D]:n})},y=()=>{N(!1),V(null)},O=async f=>{f.preventDefault();try{const D=J(I,"productos",E.idProducto);await ke(D,{nombreProducto:E.nombreProducto,precioProducto:Number(E.precioProducto),categoriaProducto:E.categoriaProducto,marcaProducto:E.marcaProducto,cantidadProducto:Number(E.cantidadProducto)}),console.log("Productos antes de actualizar:",v),console.log("Inventario filtrado antes de actualizar:",s),m(n=>n.map(u=>u.idProducto===g.idProducto?{...u,...E}:u)),c(n=>n.map(u=>u.idProducto===g.idProducto?{...u,...E}:u)),console.log("Productos después de actualizar:",v),console.log("Inventario filtrado después de actualizar:",s),y()}catch(D){console.error("Error al actualizar el producto:",D)}};s.reduce((f,D)=>f+D.cantidadProducto,0);const F=s.reduce((f,D)=>f+D.precioProducto*D.cantidadProducto,0);return h?e.jsx("p",{children:"Cargando productos..."}):b?e.jsx("p",{children:b}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"body-tabla",children:[e.jsxs("main",{className:"table",children:[e.jsxs("section",{className:"table-header",children:[e.jsxs("p",{className:"form-title",children:["Total del Inventario: $",w(F)]}),e.jsx("input",{className:"buscar",type:"text",placeholder:"Buscar producto",onChange:B})]}),e.jsx("section",{className:"table-body",children:e.jsxs("table",{className:"tabla-inventario",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Codigo"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Categoria"}),e.jsx("th",{children:"Marca"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:s.length>0?s.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:f.idProducto}),e.jsx("td",{children:f.nombreProducto}),e.jsx("td",{children:w(f.precioProducto)}),e.jsx("td",{children:f.categoriaProducto}),e.jsx("td",{children:f.marcaProducto}),e.jsx("td",{children:e.jsx("p",{className:f.cantidadProducto<=5?"cantidad-baja":f.cantidadProducto<=15?"cantidad-media":"cantidad-alta",children:f.cantidadProducto})}),e.jsx("td",{children:e.jsx("button",{className:"btn-editar",onClick:()=>M(f),children:"Editar"})})]},f.idProducto)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No hay productos disponibles"})})})]})})]}),e.jsx(ie,{open:p,onClose:y,children:g&&e.jsxs("div",{className:"formulario-editar",children:[e.jsx("p",{className:"form-title",children:"Editar Producto "}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("label",{children:["Nombre:",e.jsx("input",{type:"text",name:"nombreProducto",value:E.nombreProducto,onChange:L})]}),e.jsxs("label",{children:["Precio:",e.jsx("input",{type:"number",name:"precioProducto",value:E.precioProducto,onChange:L})]}),e.jsxs("label",{children:["Categoria:",e.jsx("input",{type:"text",name:"categoriaProducto",value:E.categoriaProducto,onChange:L})]}),e.jsxs("label",{children:["Marca:",e.jsx("input",{type:"text",name:"marcaProducto",value:E.marcaProducto,onChange:L})]}),e.jsxs("label",{children:["Cantidad:",e.jsx("input",{type:"number",name:"cantidadProducto",value:E.cantidadProducto,onChange:L})]}),e.jsx("button",{type:"submit",children:"Actualizar Producto"}),e.jsx("button",{type:"button",onClick:y,children:"Cancelar"})]})]})})]})]})},ia=()=>{const[v,m]=r.useState([]),[b,S]=r.useState(""),[s,c]=r.useState([]),[h,l]=r.useState(!0);r.useState("efectivo");const[p,N]=r.useState(""),[g,V]=r.useState(1),[E,U]=r.useState(!1),[B,w]=r.useState(!1);r.useEffect(()=>{let n=!0;return(async()=>{try{const x=W(I,"productos"),P=(await K(x)).docs.map(o=>({id:o.id,...o.data()}));n&&m(P)}catch(x){S("Error al obtener los productos"),console.error("Error al obtener los productos:",x)}finally{n&&l(!1)}})(),()=>{n=!1}},[]),r.useEffect(()=>{if(p.length>0){const n=v.find(u=>String(u.idProducto)===p);n?(E?y(n,g):L(n,g),N(""),V(1)):(S("Producto no encontrado."),setTimeout(()=>{S(""),N(""),V(1)},3e3))}},[p,v,g,E]);const M=n=>{N(n.target.value)},L=(n,u)=>{c(x=>x.find(P=>P.idProducto===n.idProducto)?x.map(P=>P.idProducto===n.idProducto?{...P,cantidad:P.cantidad+u}:P):[...x,{...n,cantidad:u}])},y=(n,u)=>{c(x=>x.find(P=>P.idProducto===n.idProducto)?x.map(P=>P.idProducto===n.idProducto?{...P,cantidad:P.cantidad+u}:P):[...x,{...n,cantidad:u}])},O=n=>{c(u=>u.map(x=>x.idProducto===n?{...x,cantidad:x.cantidad+1}:x))},F=n=>{c(u=>u.map(x=>x.idProducto===n?{...x,cantidad:Math.max(1,x.cantidad-1)}:x))},f=async n=>{n.preventDefault(),w(!0);const u=new Date,x=Y.currentUser;try{const T=s.reduce((a,i)=>a+i.precioProducto*i.cantidad,0),P=s.map(a=>({idProducto:a.idProducto,nombreProducto:a.nombreProducto,marcaProducto:a.marcaProducto,categoriaProducto:a.categoriaProducto,precioProducto:a.precioProducto,cantidad:a.cantidad})),o=x?x.uid:"";await de(W(I,"sales"),{fechaVenta:u,totalVenta:-T,idUsuario:o,productos:P,tipoPago:"devolución"});const t=le(I);s.forEach(a=>{const i=J(I,"productos",a.idProducto),j=a.cantidadProducto+a.cantidad;t.update(i,{cantidadProducto:j})}),await t.commit(),c([]),N(""),V(1),w(!1),alert("Operación realizada con éxito")}catch(T){S("Error al registrar la operación"),console.error("Error al registrar la operación:",T),w(!1)}},D=n=>`${n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return h?e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("h1",{children:"Cargando productos..."})]}):e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Devolución"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:p,onChange:M,onBlur:()=>{if(p.length>0){const n=v.find(u=>String(u.idProducto)===p);n?(E?y(n,g):L(n,g),N("")):S("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:g,min:"1",onChange:n=>{const u=parseInt(n.target.value,10);V(u<1?1:u)}})]}),e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"})]})}),e.jsx("tbody",{className:"carrito-items",children:s.map(n=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:n.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["-$",D(n.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>F(n.idProducto),children:e.jsx(H,{icon:ue})}),e.jsx("span",{className:"spanCarrito",children:n.cantidad}),e.jsx("button",{className:"boton-suma",onClick:()=>O(n.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["-$",D(n.precioProducto*n.cantidad)]})})]},n.idProducto))})]}),e.jsx("div",{className:"venta-label",children:e.jsx("div",{className:"totalcarro",children:e.jsxs("p",{className:"textp",children:["Total a Devolver: -$",D(s.reduce((n,u)=>n+u.cantidad*u.precioProducto,0))]})})}),e.jsx("div",{className:"bottom-container",children:e.jsx("button",{className:"boton-venta",onClick:f,disabled:s.length===0,children:e.jsx("span",{children:"Devolución"})})})]})})]})},ye=v=>{const m=new Date(v.seconds*1e3);return Le(m,"dd/MM/yyyy")},da=()=>{const[v,m]=r.useState([]),[b,S]=r.useState(""),[s,c]=r.useState(!0),[h,l]=r.useState(!1),[p,N]=r.useState(!1),[g,V]=r.useState(null),[E,U]=r.useState(null),[B,w]=r.useState("todos"),[M,L]=r.useState(new Date);r.useEffect(()=>{(async()=>{try{const i=W(I,"sales"),j=W(I,"users"),[d,C]=await Promise.all([K(i),K(j)]),$={};C.forEach(R=>{$[R.id]=R.data().nombreUsuario}),console.log("Users data:",$);const z=d.docs.map(R=>{const G=R.data();return console.log("Venta data:",G),{idVenta:R.id,...G,nombreUsuario:$[G.idUsuario]||"N/A"}});console.log("Ventas data:",z),m(z),c(!1)}catch(i){console.error("Error fetching data:",i),S("Ocurrió un error al cargar el historial de ventas"),c(!1)}})()},[]);const y=a=>{V(a),l(!0)},O=()=>{l(!1),V(null)},F=a=>{U(a),N(!0)},f=()=>{N(!1),U(null)},D=a=>{const{name:i,value:j}=a.target;V(d=>({...d,[i]:j}))},n=a=>{L(a)},u=async()=>{try{const a=J(I,"sales",g.idVenta);await ke(a,{idUsuario:g.idUsuario,tipoPago:g.tipoPago,totalVenta:parseFloat(g.totalVenta)}),m(i=>i.map(j=>j.idVenta===g.idVenta?g:j)),O()}catch(a){console.error("Error updating sale:",a)}},P=((a,i)=>i==="todos"?a:a.filter(j=>j.tipoPago===i))(((a,i)=>{if(!i)return a;const j=Le(new Date(i),"dd/MM/yyyy");return a.filter(d=>ye(d.fechaVenta)===j)})(v,M),B),o=a=>{switch(a){case"efectivo":return"Efectivo";case"tarjeta":return"Tarjeta";case"devolucion":return"Devolución";default:return a}},t=a=>isNaN(a)?"0":`${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("div",{className:"body-tabla",children:e.jsxs("main",{className:"table",children:[e.jsxs("section",{className:"table-header",children:[e.jsxs("p",{className:"form-title",children:["Total del día: $",t(P.reduce((a,i)=>a+(parseFloat(i.totalVenta)||0),0))]}),e.jsx(Ve,{dateAdapter:Ue,children:e.jsx(Te,{className:"fecha",label:"Selecciona una fecha",value:M,onChange:a=>n(a),renderInput:a=>e.jsx(re,{...a,style:{marginBottom:"16px"}})})}),e.jsxs(je,{className:"seleccionar-pago",children:[e.jsx(pe,{id:"tipoPago-label",children:"Tipo de Pago"}),e.jsxs(ge,{labelId:"tipoPago-label",id:"tipoPago",value:B,onChange:a=>w(a.target.value),children:[e.jsx(Q,{value:"todos",children:"Todos"}),e.jsx(Q,{value:"efectivo",children:"Efectivo"}),e.jsx(Q,{value:"tarjeta",children:"Tarjeta"}),e.jsx(Q,{value:"devolucion",children:"Devolución"})]})]}),e.jsx(Z,{className:"btn-editar",onClick:()=>console.log("Exportar a Excel"),children:"Exportar a Excel"})]}),s?e.jsx("p",{children:"Cargando..."}):b?e.jsx("p",{className:"error-message",children:b}):P.length===0?e.jsx("p",{children:"No hay ventas registradas"}):e.jsx(Xe,{component:_e,children:e.jsxs(fe,{children:[e.jsx(Pe,{children:e.jsxs(te,{children:[e.jsx(A,{children:"ID Venta"}),e.jsx(A,{children:"Fecha"}),e.jsx(A,{children:"Nombre Usuario"}),e.jsx(A,{children:"Tipo Pago"}),e.jsx(A,{children:"Total Venta"}),e.jsx(A,{children:"Acciones"})]})}),e.jsx(ve,{children:P.map(a=>e.jsxs(te,{children:[e.jsx(A,{children:a.idVenta}),e.jsx(A,{children:ye(a.fechaVenta)}),e.jsx(A,{children:a.nombreUsuario}),e.jsx(A,{children:o(a.tipoPago)}),e.jsxs(A,{children:["$",t(parseFloat(a.totalVenta)||0)]}),e.jsxs(A,{children:[e.jsx(Z,{variant:"outlined",onClick:()=>F(a),children:"Detalle"}),e.jsx(Z,{variant:"outlined",onClick:()=>y(a),children:"Editar"})]})]},a.idVenta))})]})})]})}),h&&e.jsxs(ie,{open:h,onClose:O,children:[e.jsx(be,{children:"Editar Venta"}),e.jsx(Ne,{children:g&&e.jsxs("div",{children:[e.jsxs(je,{fullWidth:!0,margin:"normal",children:[e.jsx(pe,{id:"tipoPago-label",children:"Tipo de Pago"}),e.jsxs(ge,{labelId:"tipoPago-label",id:"tipoPago",name:"tipoPago",value:g.tipoPago,onChange:D,children:[e.jsx(Q,{value:"efectivo",children:"Efectivo"}),e.jsx(Q,{value:"tarjeta",children:"Tarjeta"}),e.jsx(Q,{value:"devolucion",children:"Devolución"})]})]}),e.jsx(re,{label:"Total Venta",name:"totalVenta",value:g.totalVenta,onChange:D,fullWidth:!0,margin:"normal"})]})}),e.jsxs(Se,{children:[e.jsx(Z,{onClick:O,children:"Cancelar"}),e.jsx(Z,{onClick:u,color:"primary",children:"Guardar"})]})]}),p&&e.jsxs(ie,{open:p,onClose:f,children:[e.jsx(be,{children:"Detalle de Venta"}),e.jsx(Ne,{children:E&&e.jsxs(fe,{children:[e.jsx(Pe,{children:e.jsxs(te,{children:[e.jsx(A,{children:"ID Producto"}),e.jsx(A,{children:"Nombre Producto"}),e.jsx(A,{children:"Cantidad"}),e.jsx(A,{children:"Precio"})]})}),e.jsx(ve,{children:E.productos.map(a=>e.jsxs(te,{children:[e.jsx(A,{children:a.idProducto}),e.jsx(A,{children:a.nombreProducto}),e.jsx(A,{children:a.cantidad}),e.jsxs(A,{children:["$",t(a.precio)]})]},a.idProducto))})]})}),e.jsx(Se,{children:e.jsx(Z,{onClick:f,children:"Cerrar"})})]})]})},la=()=>{const[v,m]=r.useState([]),[b,S]=r.useState({}),[s,c]=r.useState({}),[h,l]=r.useState({}),[p,N]=r.useState(0),[g,V]=r.useState(!0),[E,U]=r.useState(null),[B,w]=r.useState(new Date),[M,L]=r.useState("todos"),y=(x,T)=>T==="todos"?x:x.filter(P=>P.tipoPago===T),O=(x,T)=>{if(!T)return x;const P=Ye(new Date(T)),o=Qe(new Date(T));return x.filter(t=>t.fecha>=P&&t.fecha<=o)},F=(x,T)=>{const P={},o={},t={};let a=0;x.forEach(i=>{const{tipoPago:j,totalVenta:d,nombreUsuario:C,productos:$}=i;P[j]=(P[j]||0)+1,o[C]=(o[C]||0)+d,$.forEach(z=>{const{idProducto:R,cantidad:G}=z,me=T[R]||R;t[me]=(t[me]||0)+G}),a+=d}),S(P),c(o),l(t),N(a)};r.useEffect(()=>{(async()=>{try{const T=W(I,"sales"),P=W(I,"users"),o=W(I,"products"),[t,a,i]=await Promise.all([K(T),K(P),K(o)]),j={};a.forEach(z=>{j[z.id]=z.data().nombreUsuario});const d={};i.forEach(z=>{d[z.id]=z.data().nombreProducto});const C=t.docs.map(z=>{const R=z.data();let G;return R.fecha&&R.fecha.toDate?G=R.fecha.toDate():R.fecha&&R.fecha.toDate===void 0?G=new Date(R.fecha):G=new Date,{idVenta:z.id,...R,nombreUsuario:j[R.idUsuario]||"N/A",fecha:G}}),$=y(O(C,B),M);F($,d),m($),V(!1)}catch(T){console.error("Error fetching data:",T),U("Ocurrió un error al cargar el historial de ventas"),V(!1)}})()},[B,M]);const f={labels:Object.keys(b),datasets:[{label:"Ventas por Tipo de Pago",data:Object.values(b),backgroundColor:["rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},D={labels:Object.keys(s),datasets:[{label:"Ventas por Usuario",data:Object.values(s),backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},n={labels:Object.keys(h),datasets:[{label:"Ventas por Producto",data:Object.values(h),backgroundColor:["rgba(54, 162, 235, 0.6)","rgba(255, 99, 132, 0.6)","rgba(75, 192, 192, 0.6)","rgba(255, 206, 86, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},u=x=>new Intl.NumberFormat("es-ES").format(x);return g?e.jsx("p",{children:"Loading..."}):E?e.jsxs("p",{children:["Error: ",E]}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"date-filter",children:[e.jsx("h3",{children:"Filtrar por Fecha"}),e.jsx(Ve,{dateAdapter:Ue,children:e.jsx(Te,{value:B,onChange:x=>w(x),renderInput:x=>e.jsx(re,{...x,style:{marginBottom:"16px"}})})})]}),e.jsx("div",{className:"metrics",children:e.jsxs("h2",{children:["Total Ventas: $",u(p.toFixed(0))]})}),e.jsxs("div",{className:"charts-container",children:[e.jsxs("div",{className:"pie-chart",children:[e.jsx("h3",{children:"Ventas por Tipo de Pago"}),e.jsx(Ze,{data:f})]}),e.jsxs("div",{className:"bar-charts",children:[e.jsxs("div",{className:"chart",children:[e.jsx("h3",{children:"Ventas por Usuario"}),e.jsx(Ce,{data:D})]}),e.jsxs("div",{className:"chart",children:[e.jsx("h3",{children:"Ventas por Producto"}),e.jsx(Ce,{data:n})]})]})]})]})]})},ua=()=>{const v=se(),[m,b]=ee.useState(!1),{signOut:S}=xe(),s=async()=>{try{await S(),v("/")}catch(l){console.error("Error al cerrar sesión:",l)}},c=()=>{b(!m)},h=()=>{b(!1)};return ee.useEffect(()=>{const l=()=>{window.innerWidth>=800&&h()};return window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}},[]),e.jsxs("nav",{className:"navbar",children:[e.jsxs("ul",{className:`sidebar ${m?"visible":""}`,children:[e.jsx("li",{onClick:h,children:e.jsx(k,{className:"menu",to:"#",children:e.jsx(H,{icon:Ie})})}),e.jsx("li",{children:e.jsx(k,{className:"link",to:"/vendedor/ventas",children:"Venta"})}),e.jsx("li",{children:e.jsx(k,{className:"link",to:"/vendedor/inventario",children:"Inventario"})}),e.jsx("li",{children:e.jsx(k,{className:"link",to:"/vendedor/devolucion",children:"Devolución"})}),e.jsx("li",{children:e.jsx(k,{className:"link",onClick:s,children:"Cerrar Sesion"})})]}),e.jsxs("ul",{children:[e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:"link",to:"/vendedor/inventario",children:"Inventario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:"link",to:"/vendedor/ventas",children:"Venta"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:"link",to:"/vendedor/devolucion",children:"Devolución"})}),e.jsx("li",{className:"Mobile",children:e.jsx(k,{className:"link",onClick:s,children:"Cerrar Sesion"})}),e.jsx("li",{onClick:c,children:e.jsx(k,{className:"menu",to:"#",children:e.jsx(H,{icon:Be})})})]})]})},ha=()=>{const{currentUser:v}=r.useContext(oe),[m,b]=r.useState([]),[S,s]=r.useState(""),[c,h]=r.useState([]),[l,p]=r.useState(!0),[N,g]=r.useState("efectivo"),[V,E]=r.useState(0),[U,B]=r.useState(0),[w,M]=r.useState(""),[L,y]=r.useState(1);r.useEffect(()=>{(async()=>{try{const a=(await K(W(I,"productos"))).docs.map(i=>({id:i.id,...i.data()}));b(a)}catch(t){s("Error al obtener los productos"),console.error("Error al obtener los productos:",t)}finally{p(!1)}})()},[v]),r.useEffect(()=>{if(w.length>0){const o=m.find(t=>String(t.id)===w);o?(F(o,L),M(""),y(1)):(s("Producto no encontrado."),setTimeout(()=>{s(""),M(""),y(1)},3e3))}},[w,m,L]);const O=o=>{M(o.target.value)},F=(o,t)=>{h(a=>{const i=a.find(j=>j.id===o.id);return i?i.cantidad+t<=o.cantidadProducto?a.map(j=>j.id===o.id?{...j,cantidad:j.cantidad+t}:j):(alert("Stock insuficiente"),a):o.cantidadProducto>=t?[...a,{...o,cantidad:t}]:(alert("Stock insuficiente"),a)})},f=o=>{h(t=>{var j;const a=t.find(d=>d.id===o),i=(j=m.find(d=>d.id===o))==null?void 0:j.cantidadProducto;return a&&i>a.cantidad?t.map(d=>d.id===o?{...d,cantidad:d.cantidad+1}:d):(alert("Stock insuficiente"),t)})},D=o=>{h(t=>t.map(a=>a.id===o?{...a,cantidad:Math.max(1,a.cantidad-1)}:a))},n=o=>{h(t=>t.filter(a=>a.id!==o))},u=o=>{g(o.target.value),o.target.value==="efectivo"&&(E(0),B(0))},x=o=>{const t=parseFloat(o.target.value);E(t);const a=c.reduce((i,j)=>i+j.precioProducto*j.cantidad,0);B(t-a)},T=async o=>{o.preventDefault();const t=new Date,a=c.reduce((d,C)=>d+C.precioProducto*C.cantidad,0),i=c.map(d=>({idProducto:d.id,nombreProducto:d.nombreProducto,marcaProducto:d.marcaProducto,categoriaProducto:d.categoriaProducto,precioProducto:d.precioProducto,cantidad:d.cantidad,cantidadProducto:d.cantidadProducto})),j=Y.currentUser;try{await de(W(I,"sales"),{fechaVenta:t,totalVenta:a,tipoPago:N,idUsuario:j.uid,productos:i});const d=le(I);c.forEach(C=>{const $=J(I,"productos",C.id);d.update($,{cantidadProducto:C.cantidadProducto-C.cantidad})}),await d.commit(),h([]),alert("Venta registrada con éxito")}catch(d){s("Error al registrar la venta"),console.error("Error al registrar la venta:",d)}},P=o=>`${o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return l?e.jsx("div",{children:e.jsx("h1",{children:"Cargando productos..."})}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(ua,{})}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Carrito de compras"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:w,onChange:O,onBlur:()=>{if(w.length>0){const o=m.find(t=>String(t.id)===w);o?(F(o),M("")):s("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:L,min:"1",onChange:o=>{const t=parseInt(o.target.value);y(t<1?1:t)}})]}),S&&e.jsx("p",{className:"error",children:S}),e.jsx("section",{className:"tabla-ventas",children:e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"}),e.jsx("th",{className:"carrito-th",children:"Acciones"})]})}),e.jsx("tbody",{className:"carrito-items",children:c.map(o=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:o.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",P(o.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>D(o.idProducto),children:e.jsx(H,{icon:ue})}),o.cantidad,e.jsx("button",{className:"boton-suma",onClick:()=>f(o.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",P(o.precioProducto*o.cantidad)]})}),e.jsx("td",{className:"carrito-td",children:e.jsx("button",{className:"boton-eliminar",onClick:()=>n(o.idProducto),children:e.jsx(H,{icon:Me})})})]},o.idProducto))})]})}),e.jsxs("div",{className:"pago",children:[e.jsx("label",{htmlFor:"tipoPago",children:"Tipo de pago:"}),e.jsxs("select",{id:"tipoPago",value:N,onChange:u,className:"carrito-input",children:[e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"tarjeta",children:"Tarjeta"})]}),N==="efectivo"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cantidadEntregada",children:"Cantidad entregada:"}),e.jsx("input",{id:"cantidadEntregada",type:"number",value:V,onChange:x,className:"carrito-input"}),e.jsxs("p",{className:"textp",children:["Vuelto: $",P(U)]})]})]}),e.jsx("button",{className:"boton-venta",onClick:T,children:e.jsx("span",{children:"Finalizar Venta"})})]})})]})};function _({children:v,allowedRoles:m}){const{user:b,role:S}=xe();return b?m&&!m.includes(S)?e.jsx(ce,{to:"/unauthorized"}):v:e.jsx(ce,{to:"/login"})}function xa(){return e.jsxs(Ke,{children:[e.jsx(q,{path:"/",element:e.jsx(ce,{to:"/login"})}),e.jsx(q,{path:"/login",element:e.jsx(ta,{})}),e.jsx(q,{path:"/resetPassword",element:e.jsx(ra,{})}),e.jsx(q,{path:"/agregarUsuario",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(sa,{})})}),e.jsx(q,{path:"/agregarProducto",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(oa,{})})}),e.jsx(q,{path:"/dashboard",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(la,{})})}),e.jsx(q,{path:"/ventas",element:e.jsx(_,{allowedRoles:["admin","vendedor"],children:e.jsx(na,{})})}),e.jsx(q,{path:"/inventario",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(ca,{})})}),e.jsx(q,{path:"/devolucion",element:e.jsx(_,{allowedRoles:["admin","vendedor"],children:e.jsx(ia,{})})}),e.jsx(q,{path:"/historial",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(da,{})})}),e.jsx(q,{path:"/vendedor/ventas",element:e.jsx(_,{allowedRoles:["vendedor"],children:e.jsx(ha,{})})}),e.jsx(q,{path:"/unauthorized",element:e.jsx("div",{children:"Unauthorized - You do not have permission to view this page."})})]})}Ae.createRoot(document.getElementById("root")).render(e.jsx(ee.StrictMode,{children:e.jsx(Ge,{children:e.jsx(aa,{children:e.jsx(xa,{})})})}));
