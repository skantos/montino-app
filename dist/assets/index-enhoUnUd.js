import{r,j as e,a as ee}from"./react-MB1aJdB0.js";import{c as Le}from"./react-dom-babtui9j.js";import{g as Ee,s as Fe,a as De,b as $e,c as Re}from"./firebase-BOREzNWu.js";import{u as Oe,v as ze,w as qe,x as We,y as He,z as J,A as ne,B as we,D as K,G as W,H as de,I as le,J as ke}from"./@firebase-Bzy7ECXp.js";import{L as D,B as Ge}from"./react-router-dom-BP5qz8hL.js";import{a as se,b as Je,d as Ke,e as q,f as ce}from"./react-router-BDFDsiw1.js";import{T as re,B as Z,D as ie,L as Ve,A as Ue,a as Te,F as je,I as pe,S as ge,M as Q,b as Xe,P as _e,c as Pe,d as fe,e as te,f as A,g as ve,h as be,i as Ne,j as Se}from"./@mui-D6ajMDpQ.js";import{F as H,f as Ie,a as Be,b as ue,c as he,d as Me}from"./@fortawesome-CTlQ_N8p.js";import{f as Ae,t as Ye,m as Qe}from"./date-fns-5tFtsWfW.js";import{P as Ze,B as Ce}from"./react-chartjs-2-BMTf87bo.js";import"./chart.js-C_W9Dm9B.js";import"./@babel-DdaQcUjw.js";import"./scheduler-CzFDRTuY.js";import"./tslib-BGVaTf34.js";import"./safevalues-NrgD-8pg.js";import"./idb-Bn1DMRyg.js";import"./@remix-run-BFLWy9pZ.js";import"./react-is-DcfIKM1A.js";import"./clsx-B-dksMZM.js";import"./@emotion-D2LlJvDI.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./prop-types-D-iIXjl8.js";import"./react-transition-group-DD9RWrmj.js";import"./dom-helpers-D0mFdbeO.js";import"./@popperjs-BQBsAJpH.js";import"./@kurkle-BZxJdD1U.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))S(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const x of d.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&S(x)}).observe(document,{childList:!0,subtree:!0});function f(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function S(o){if(o.ep)return;o.ep=!0;const d=f(o);fetch(o.href,d)}})();const ea={apiKey:"AIzaSyAP7Af1h_-zBmBfL_A5K2uuJsJDFuOel0c",authDomain:"local-js-d7712.firebaseapp.com",projectId:"local-js-d7712",storageBucket:"local-js-d7712.appspot.com",messagingSenderId:"200538761653",appId:"1:200538761653:web:571a969ac8a572328451fc",measurementId:"G-XXD5WT5TV1"},ae=Oe(ea),Y=Ee(ae),U=ze(ae);qe(ae);We(ae);He(ae);const oe=r.createContext();function aa({children:P}){const[m,f]=r.useState(null),[S,o]=r.useState(null);r.useEffect(()=>{const u=Y.onAuthStateChanged(async j=>{if(j){f(j);const N=J(U,"users",j.uid),g=await ne(N);g.exists()?o(g.data().rolUsuario):o(null)}else f(null),o(null)});return()=>u()},[]);const d=async(u,j)=>{try{const N=await Fe(Y,u,j);f(N.user);const g=J(U,"users",N.user.uid),w=await ne(g);w.exists()?o(w.data().rolUsuario):o(null)}catch(N){throw console.error("Error signing in:",N),N}},x=async()=>{try{await De(Y),f(null),o(null)}catch(u){throw console.error("Error signing out:",u),u}};return e.jsx(oe.Provider,{value:{user:m,role:S,signIn:d,signOut:x},children:P})}function xe(){return r.useContext(oe)}function ta(){const[P,m]=r.useState(""),[f,S]=r.useState(""),[o,d]=r.useState(""),x=se(),{signIn:u,role:j}=xe(),N=async g=>{g.preventDefault(),d("");try{await u(P,f)}catch(w){d("Usuario o contraseña incorrectos"),console.error("Error al iniciar sesión:",w)}};return r.useEffect(()=>{j&&(j==="admin"?x("/ventas"):j==="vendedor"?x("/vendedor/ventas"):d("Rol de usuario no reconocido"))},[j,x]),e.jsx("div",{children:e.jsx("div",{className:"login-box",children:e.jsxs("form",{className:"form",onSubmit:N,children:[e.jsxs("p",{className:"form-title",children:["Los Tios ",e.jsx("br",{}),"Iniciar Sesión"]}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"email",placeholder:"Email",value:P,onChange:g=>m(g.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"password",placeholder:"Contraseña",value:f,onChange:g=>S(g.target.value),required:!0})}),o&&e.jsx("p",{className:"signup-link",children:o}),e.jsx("button",{type:"submit",className:"submit",children:"Ingresar"}),e.jsx("p",{className:"signup-link",children:e.jsx(D,{to:"/resetPassword",className:"resetPassword",children:"Olvidé mi Contraseña"})})]})})})}const ra=()=>{const[P,m]=r.useState(""),[f,S]=r.useState(!1),[o,d]=r.useState(null),x=se(),u=()=>{$e(Y,P).then(()=>{S(!0),setTimeout(()=>{x("/")},6e3)}).catch(j=>{d("No se pudo enviar el correo electrónico de restablecimiento de contraseña.")})};return e.jsxs("div",{className:"recuperar-contrasena",children:[e.jsx("h1",{children:"Recuperar Contraseña"}),f?e.jsx("p",{children:"Se ha enviado un correo electrónico con instrucciones para restablecer tu contraseña."}):e.jsxs(e.Fragment,{children:[e.jsx(re,{type:"email",label:"Correo Electrónico",value:P,onChange:j=>m(j.target.value),sx:{width:"16%"}}),e.jsx(Z,{onClick:u,variant:"outlined",sx:{fontSize:"19px",marginBottom:"19px",top:"10px"},children:"Enviar"}),o&&e.jsx("p",{style:{color:"red"},children:o})]})]})},X=()=>{const P=se(),m=Je(),[f,S]=ee.useState(!1),o=async()=>{const j=Ee();try{await De(j),localStorage.removeItem("token"),P("/")}catch(N){console.error("Error al cerrar sesión:",N)}},d=()=>{S(!f)},x=()=>{S(!1)};ee.useEffect(()=>{const j=()=>{window.innerWidth>=800&&x()};return window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}},[]);const u=j=>m.pathname===j?"active":"";return e.jsxs("nav",{className:"navbar",children:[e.jsxs("ul",{className:`sidebar ${f?"visible":""}`,children:[e.jsx("li",{onClick:x,children:e.jsx(D,{className:"menu",to:"#",children:e.jsx(H,{icon:Ie})})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/ventas")}`,to:"/ventas",children:"Venta"})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/agregarProducto")}`,to:"/agregarProducto",children:"Agregar Producto"})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/agregarUsuario")}`,to:"/agregarUsuario",children:"Agregar Usuario"})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/inventario")}`,to:"/inventario",children:"Inventario"})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/devolucion")}`,to:"/devolucion",children:"Devolución"})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/dashboard")}`,to:"/dashboard",children:"Dashboard"})}),e.jsx("li",{children:e.jsx(D,{className:`link ${u("/historial")}`,to:"/historial",children:"Historial"})}),e.jsx("li",{children:e.jsx(D,{className:"link",onClick:o,children:"Cerrar Sesión"})})]}),e.jsxs("ul",{children:[e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/dashboard")}`,to:"/dashboard",children:"Dashboard"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/agregarProducto")}`,to:"/agregarProducto",children:"Agregar Producto"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/agregarUsuario")}`,to:"/agregarUsuario",children:"Agregar Usuario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/devolucion")}`,to:"/devolucion",children:"Devolución"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/ventas")}`,to:"/ventas",children:"Venta"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/inventario")}`,to:"/inventario",children:"Inventario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:`link ${u("/historial")}`,to:"/historial",children:"Historial"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:"link",onClick:o,children:"Cerrar Sesión"})}),e.jsx("li",{onClick:d,children:e.jsx(D,{className:"menu",to:"#",children:e.jsx(H,{icon:Be})})})]})]})},sa=()=>{const[P,m]=r.useState(""),[f,S]=r.useState(""),[o,d]=r.useState(""),[x,u]=r.useState("vendedor"),[j,N]=r.useState(""),[g,w]=r.useState(""),y=async k=>{k.preventDefault(),console.log("Nombre de Usuario:",P),console.log("Email:",f),console.log("Contraseña:",o),console.log("Rol:",x);try{const E=(await Re(Y,f,o)).user;console.log("Usuario creado:",E),await we(J(U,"users",E.uid),{nombreUsuario:P,emailUsuario:f,rolUsuario:x}),w("Usuario registrado exitosamente"),m(""),S(""),d(""),u("vendedor")}catch(T){console.error("Error al registrar el usuario:",T),T.code==="auth/email-already-in-use"?N("El correo electrónico ya está en uso. Por favor, use otro."):T.code==="permission-denied"?N("Permiso denegado. Verifica las reglas de seguridad."):N("Error al registrar el usuario")}};return e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"login-box",children:[e.jsx("p",{className:"form-title",children:"Registrar Usuario"}),e.jsxs("form",{className:"form",onSubmit:y,children:[e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"text",placeholder:"Nombre de Usuario",value:P,onChange:k=>m(k.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"email",placeholder:"Email",value:f,onChange:k=>S(k.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"password",placeholder:"Contraseña",value:o,onChange:k=>d(k.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsxs("select",{value:x,onChange:k=>u(k.target.value),required:!0,children:[e.jsx("option",{value:"vendedor",children:"Vendedor"}),e.jsx("option",{value:"admin",children:"Administrador"})]})}),j&&e.jsx("p",{className:"signup-link",children:j}),g&&e.jsx("p",{className:"signup-link",children:g}),e.jsx("button",{className:"submit",type:"submit",children:"Registrar Usuario"})]})]})]})},oa=()=>{const[P,m]=r.useState(""),[f,S]=r.useState(""),[o,d]=r.useState(""),[x,u]=r.useState(""),[j,N]=r.useState(""),[g,w]=r.useState(""),[y,k]=r.useState(""),[T,E]=r.useState(""),I=async()=>{try{const C=J(U,"productos",P);return(await ne(C)).exists()}catch(C){return console.error("Error checking product existence:",C),k("Error al verificar la existencia del producto"),!1}},B=async C=>{if(C.preventDefault(),await I()){k("El producto ya está registrado");return}try{const L=J(U,"productos",P);await we(L,{idProducto:P,nombreProducto:f,precioProducto:o,categoriaProducto:x,marcaProducto:j,cantidadProducto:g}),E("Producto registrado exitosamente"),m(""),S(""),d(""),u(""),N(""),w(""),k("")}catch(L){k("Hubo un error al registrar el producto"),console.error("Error al registrar el producto:",L)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("div",{children:e.jsxs("div",{className:"productos-box",children:[e.jsx("p",{className:"form-title",children:"Ingresar Producto"}),e.jsxs("form",{className:"form-producto",onSubmit:B,children:[e.jsxs("div",{className:"detalle",children:[e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Código Producto"}),e.jsx("input",{type:"text",placeholder:"Id Producto",value:P,onChange:C=>m(C.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Nombre producto"}),e.jsx("input",{type:"text",placeholder:"Nombre Producto",value:f,onChange:C=>S(C.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Precio Producto"}),e.jsx("input",{type:"text",placeholder:"Precio Producto",value:o,onChange:C=>d(C.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Categoria Producto"}),e.jsx("input",{type:"text",placeholder:"Categoria Producto",value:x,onChange:C=>u(C.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Marca Producto"}),e.jsx("input",{type:"text",placeholder:"Marca Producto",value:j,onChange:C=>N(C.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Cantidad Producto"}),e.jsx("input",{type:"text",placeholder:"Cantidad Producto",value:g,onChange:C=>w(C.target.value),required:!0})]})]}),y&&e.jsx("p",{className:"form-title",children:y}),T&&e.jsx("p",{className:"form-title",children:T}),e.jsx("button",{className:"submit",type:"submit",children:"Agregar Producto"})]})]})})]})},na=()=>{const{currentUser:P}=r.useContext(oe),[m,f]=r.useState([]),[S,o]=r.useState(""),[d,x]=r.useState([]),[u,j]=r.useState(!0),[N,g]=r.useState("efectivo"),[w,y]=r.useState(0),[k,T]=r.useState(0),[E,I]=r.useState(""),[B,C]=r.useState(1);r.useEffect(()=>{(async()=>{try{const a=(await K(W(U,"productos"))).docs.map(l=>({id:l.id,...l.data()}));f(a)}catch(s){o("Error al obtener los productos"),console.error("Error al obtener los productos:",s)}finally{j(!1)}})()},[P]),r.useEffect(()=>{if(E.length>0){const t=m.find(s=>String(s.id)===E);t?(L(t,B),I(""),C(1)):(o("Producto no encontrado."),setTimeout(()=>{o(""),I(""),C(1)},3e3))}},[E,m,B]);const $=t=>{I(t.target.value)},L=(t,s)=>{x(a=>{const l=a.find(h=>h.id===t.id);return l?l.cantidad+s<=t.cantidadProducto?a.map(h=>h.id===t.id?{...h,cantidad:h.cantidad+s}:h):(alert("Stock insuficiente"),a):t.cantidadProducto>=s?[...a,{...t,cantidad:s}]:(alert("Stock insuficiente"),a)})},O=t=>{x(s=>{var h;const a=s.find(i=>i.id===t),l=(h=m.find(i=>i.id===t))==null?void 0:h.cantidadProducto;return a&&l>a.cantidad?s.map(i=>i.id===t?{...i,cantidad:i.cantidad+1}:i):(alert("Stock insuficiente"),s)})},p=t=>{x(s=>s.map(a=>a.id===t?{...a,cantidad:Math.max(1,a.cantidad-1)}:a))},n=t=>{x(s=>s.filter(a=>a.id!==t))},v=t=>{g(t.target.value),t.target.value==="efectivo"&&(y(0),T(0))},c=t=>{const s=parseFloat(t.target.value);y(s);const a=d.reduce((l,h)=>l+h.precioProducto*h.cantidad,0);T(s-a)},V=async t=>{t.preventDefault();const s=new Date,a=d.reduce((i,M)=>i+M.precioProducto*M.cantidad,0),l=d.map(i=>({idProducto:i.id,nombreProducto:i.nombreProducto,marcaProducto:i.marcaProducto,categoriaProducto:i.categoriaProducto,precioProducto:i.precioProducto,cantidad:i.cantidad,cantidadProducto:i.cantidadProducto})),h=Y.currentUser;try{await de(W(U,"sales"),{fechaVenta:s,totalVenta:a,tipoPago:N,idUsuario:h.uid,productos:l});const i=le(U);d.forEach(M=>{const z=J(U,"productos",M.id);i.update(z,{cantidadProducto:M.cantidadProducto-M.cantidad})}),await i.commit(),x([]),alert("Venta registrada con éxito")}catch(i){o("Error al registrar la venta"),console.error("Error al registrar la venta:",i)}},b=t=>`${t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return u?e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("h1",{children:"Cargando productos..."})]}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Carrito de compras"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:E,onChange:$,onBlur:()=>{if(E.length>0){const t=m.find(s=>String(s.id)===E);t?(L(t),I("")):o("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:B,min:"1",onChange:t=>{const s=parseInt(t.target.value);C(s<1?1:s)}})]}),S&&e.jsx("p",{className:"error",children:S}),e.jsx("section",{className:"tabla-ventas",children:e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"}),e.jsx("th",{className:"carrito-th",children:"Acciones"})]})}),e.jsx("tbody",{className:"carrito-items",children:d.map(t=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:t.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",b(t.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>p(t.idProducto),children:e.jsx(H,{icon:ue})}),t.cantidad,e.jsx("button",{className:"boton-suma",onClick:()=>O(t.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",b(t.precioProducto*t.cantidad)]})}),e.jsx("td",{className:"carrito-td",children:e.jsx("button",{className:"boton-eliminar",onClick:()=>n(t.idProducto),children:e.jsx(H,{icon:Me})})})]},t.idProducto))})]})}),e.jsxs("div",{className:"pago",children:[e.jsx("label",{htmlFor:"tipoPago",children:"Tipo de pago:"}),e.jsxs("select",{id:"tipoPago",value:N,onChange:v,className:"carrito-input",children:[e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"tarjeta",children:"Tarjeta"})]}),N==="efectivo"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cantidadEntregada",children:"Cantidad entregada:"}),e.jsx("input",{id:"cantidadEntregada",type:"number",value:w,onChange:c,className:"carrito-input"}),e.jsxs("p",{className:"textp",children:["Vuelto: $",b(k)]})]})]}),e.jsx("button",{className:"boton-venta",onClick:V,children:e.jsx("span",{children:"Finalizar Venta"})})]})})]})},ca=()=>{const[P,m]=r.useState([]),[f,S]=r.useState(""),[o,d]=r.useState([]),[x,u]=r.useState(!0),[j,N]=r.useState(!1),[g,w]=r.useState(null),[y,k]=r.useState({idProducto:"",nombreProducto:"",precioProducto:"",categoriaProducto:"",marcaProducto:"",cantidadProducto:""});r.useEffect(()=>{(async()=>{try{const v=(await K(W(U,"productos"))).docs.map(c=>({idProducto:c.id,...c.data()}));m(v),d(v)}catch{S("Error al cargar los productos. Intente más tarde.")}finally{u(!1)}})()},[]);const T=p=>{const n=p.target.value.toLowerCase();if(n==="")d(P);else{const v=P.filter(c=>{const V=String(c.idProducto).toLowerCase(),b=String(c.nombreProducto).toLowerCase(),t=String(c.precioProducto).toLowerCase(),s=String(c.categoriaProducto).toLowerCase(),a=String(c.marcaProducto).toLowerCase(),l=String(c.cantidadProducto).toLowerCase();return V.includes(n)||b.includes(n)||t.includes(n)||s.includes(n)||a.includes(n)||l.includes(n)});d(v)}},E=p=>`${p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`,I=p=>{w(p),k({idProducto:p.idProducto,nombreProducto:p.nombreProducto,precioProducto:p.precioProducto,categoriaProducto:p.categoriaProducto,marcaProducto:p.marcaProducto,cantidadProducto:p.cantidadProducto}),N(!0)},B=p=>{const{name:n,value:v}=p.target;k({...y,[n]:v})},C=()=>{N(!1),w(null)},$=async p=>{p.preventDefault();try{const n=J(U,"productos",y.idProducto);await ke(n,{nombreProducto:y.nombreProducto,precioProducto:Number(y.precioProducto),categoriaProducto:y.categoriaProducto,marcaProducto:y.marcaProducto,cantidadProducto:Number(y.cantidadProducto)}),console.log("Productos antes de actualizar:",P),console.log("Inventario filtrado antes de actualizar:",o),m(v=>v.map(c=>c.idProducto===g.idProducto?{...c,...y}:c)),d(v=>v.map(c=>c.idProducto===g.idProducto?{...c,...y}:c)),console.log("Productos después de actualizar:",P),console.log("Inventario filtrado después de actualizar:",o),C()}catch(n){console.error("Error al actualizar el producto:",n)}},L=o.reduce((p,n)=>p+n.cantidadProducto,0),O=o.reduce((p,n)=>p+n.precioProducto*n.cantidadProducto,0);return x?e.jsx("p",{children:"Cargando productos..."}):f?e.jsx("p",{children:f}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"body-tabla",children:[e.jsxs("main",{className:"table",children:[e.jsxs("section",{className:"table-header",children:[e.jsxs("p",{className:"form-title",children:["Total del Inventario: $",E(O)]}),e.jsxs("p",{className:"form-title",children:["Total de productos: ",L]}),e.jsx("input",{className:"buscar",type:"text",placeholder:"Buscar producto",onChange:T})]}),e.jsx("section",{className:"table-body",children:e.jsxs("table",{className:"tabla-inventario",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Codigo"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Categoria"}),e.jsx("th",{children:"Marca"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:o.length>0?o.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.idProducto}),e.jsx("td",{children:p.nombreProducto}),e.jsx("td",{children:E(p.precioProducto)}),e.jsx("td",{children:p.categoriaProducto}),e.jsx("td",{children:p.marcaProducto}),e.jsx("td",{children:e.jsx("p",{className:p.cantidadProducto<=5?"cantidad-baja":p.cantidadProducto<=15?"cantidad-media":"cantidad-alta",children:p.cantidadProducto})}),e.jsx("td",{children:e.jsx("button",{className:"btn-editar",onClick:()=>I(p),children:"Editar"})})]},p.idProducto)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No hay productos disponibles"})})})]})})]}),e.jsx(ie,{open:j,onClose:C,children:g&&e.jsxs("div",{className:"formulario-editar",children:[e.jsx("p",{className:"form-title",children:"Editar Producto "}),e.jsxs("form",{onSubmit:$,children:[e.jsxs("label",{children:["Nombre:",e.jsx("input",{type:"text",name:"nombreProducto",value:y.nombreProducto,onChange:B})]}),e.jsxs("label",{children:["Precio:",e.jsx("input",{type:"number",name:"precioProducto",value:y.precioProducto,onChange:B})]}),e.jsxs("label",{children:["Categoria:",e.jsx("input",{type:"text",name:"categoriaProducto",value:y.categoriaProducto,onChange:B})]}),e.jsxs("label",{children:["Marca:",e.jsx("input",{type:"text",name:"marcaProducto",value:y.marcaProducto,onChange:B})]}),e.jsxs("label",{children:["Cantidad:",e.jsx("input",{type:"number",name:"cantidadProducto",value:y.cantidadProducto,onChange:B})]}),e.jsx("button",{type:"submit",children:"Actualizar Producto"}),e.jsx("button",{type:"button",onClick:C,children:"Cancelar"})]})]})})]})]})},ia=()=>{const[P,m]=r.useState([]),[f,S]=r.useState(""),[o,d]=r.useState([]),[x,u]=r.useState(!0);r.useState("efectivo");const[j,N]=r.useState(""),[g,w]=r.useState(1),[y,k]=r.useState(!1),[T,E]=r.useState(!1);r.useEffect(()=>{let n=!0;return(async()=>{try{const c=W(U,"productos"),b=(await K(c)).docs.map(t=>({id:t.id,...t.data()}));n&&m(b)}catch(c){S("Error al obtener los productos"),console.error("Error al obtener los productos:",c)}finally{n&&u(!1)}})(),()=>{n=!1}},[]),r.useEffect(()=>{if(j.length>0){const n=P.find(v=>String(v.idProducto)===j);n?(y?C(n,g):B(n,g),N(""),w(1)):(S("Producto no encontrado."),setTimeout(()=>{S(""),N(""),w(1)},3e3))}},[j,P,g,y]);const I=n=>{N(n.target.value)},B=(n,v)=>{d(c=>c.find(b=>b.idProducto===n.idProducto)?c.map(b=>b.idProducto===n.idProducto?{...b,cantidad:b.cantidad+v}:b):[...c,{...n,cantidad:v}])},C=(n,v)=>{d(c=>c.find(b=>b.idProducto===n.idProducto)?c.map(b=>b.idProducto===n.idProducto?{...b,cantidad:b.cantidad+v}:b):[...c,{...n,cantidad:v}])},$=n=>{d(v=>v.map(c=>c.idProducto===n?{...c,cantidad:c.cantidad+1}:c))},L=n=>{d(v=>v.map(c=>c.idProducto===n?{...c,cantidad:Math.max(1,c.cantidad-1)}:c))},O=async n=>{n.preventDefault(),E(!0);const v=new Date,c=Y.currentUser;try{const V=o.reduce((a,l)=>a+l.precioProducto*l.cantidad,0),b=o.map(a=>({idProducto:a.idProducto,nombreProducto:a.nombreProducto,marcaProducto:a.marcaProducto,categoriaProducto:a.categoriaProducto,precioProducto:a.precioProducto,cantidad:a.cantidad})),t=c?c.uid:"";await de(W(U,"sales"),{fechaVenta:v,totalVenta:-V,idUsuario:t,productos:b,tipoPago:"devolución"});const s=le(U);o.forEach(a=>{const l=J(U,"productos",a.idProducto),h=a.cantidadProducto+a.cantidad;s.update(l,{cantidadProducto:h})}),await s.commit(),d([]),N(""),w(1),E(!1),alert("Operación realizada con éxito")}catch(V){S("Error al registrar la operación"),console.error("Error al registrar la operación:",V),E(!1)}},p=n=>`${n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return x?e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("h1",{children:"Cargando productos..."})]}):e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Devolución"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:j,onChange:I,onBlur:()=>{if(j.length>0){const n=P.find(v=>String(v.idProducto)===j);n?(y?C(n,g):B(n,g),N("")):S("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:g,min:"1",onChange:n=>{const v=parseInt(n.target.value,10);w(v<1?1:v)}})]}),e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"})]})}),e.jsx("tbody",{className:"carrito-items",children:o.map(n=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:n.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["-$",p(n.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>L(n.idProducto),children:e.jsx(H,{icon:ue})}),e.jsx("span",{className:"spanCarrito",children:n.cantidad}),e.jsx("button",{className:"boton-suma",onClick:()=>$(n.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["-$",p(n.precioProducto*n.cantidad)]})})]},n.idProducto))})]}),e.jsx("div",{className:"venta-label",children:e.jsx("div",{className:"totalcarro",children:e.jsxs("p",{className:"textp",children:["Total a Devolver: -$",p(o.reduce((n,v)=>n+v.cantidad*v.precioProducto,0))]})})}),e.jsx("div",{className:"bottom-container",children:e.jsx("button",{className:"boton-venta",onClick:O,disabled:o.length===0,children:e.jsx("span",{children:"Devolución"})})})]})})]})},ye=P=>{const m=new Date(P.seconds*1e3);return Ae(m,"dd/MM/yyyy")},da=()=>{const[P,m]=r.useState([]),[f,S]=r.useState(""),[o,d]=r.useState(!0),[x,u]=r.useState(!1),[j,N]=r.useState(!1),[g,w]=r.useState(null),[y,k]=r.useState(null),[T,E]=r.useState("todos"),[I,B]=r.useState(new Date);r.useEffect(()=>{(async()=>{try{const l=W(U,"sales"),h=W(U,"users"),[i,M]=await Promise.all([K(l),K(h)]),z={};M.forEach(F=>{z[F.id]=F.data().nombreUsuario}),console.log("Users data:",z);const R=i.docs.map(F=>{const G=F.data();return console.log("Venta data:",G),{idVenta:F.id,...G,nombreUsuario:z[G.idUsuario]||"N/A"}});console.log("Ventas data:",R),m(R),d(!1)}catch(l){console.error("Error fetching data:",l),S("Ocurrió un error al cargar el historial de ventas"),d(!1)}})()},[]);const C=a=>{w(a),u(!0)},$=()=>{u(!1),w(null)},L=a=>{k(a),N(!0)},O=()=>{N(!1),k(null)},p=a=>{const{name:l,value:h}=a.target;w(i=>({...i,[l]:h}))},n=a=>{B(a)},v=async()=>{try{const a=J(U,"sales",g.idVenta);await ke(a,{idUsuario:g.idUsuario,tipoPago:g.tipoPago,totalVenta:parseFloat(g.totalVenta)}),m(l=>l.map(h=>h.idVenta===g.idVenta?g:h)),$()}catch(a){console.error("Error updating sale:",a)}},b=((a,l)=>l==="todos"?a:a.filter(h=>h.tipoPago===l))(((a,l)=>{if(!l)return a;const h=Ae(new Date(l),"dd/MM/yyyy");return a.filter(i=>ye(i.fechaVenta)===h)})(P,I),T),t=a=>{switch(a){case"efectivo":return"Efectivo";case"tarjeta":return"Tarjeta";case"devolucion":return"Devolución";default:return a}},s=a=>isNaN(a)?"0":`${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("div",{className:"body-tabla",children:e.jsxs("main",{className:"table",children:[e.jsxs("section",{className:"table-header",children:[e.jsxs("p",{className:"form-title",children:["Total del día: $",s(b.reduce((a,l)=>a+(parseFloat(l.totalVenta)||0),0))]}),e.jsx(Ve,{dateAdapter:Ue,children:e.jsx(Te,{className:"fecha",label:"Selecciona una fecha",value:I,onChange:a=>n(a),renderInput:a=>e.jsx(re,{...a,style:{marginBottom:"16px"}})})}),e.jsxs(je,{className:"seleccionar-pago",children:[e.jsx(pe,{id:"tipoPago-label",children:"Tipo de Pago"}),e.jsxs(ge,{labelId:"tipoPago-label",id:"tipoPago",value:T,onChange:a=>E(a.target.value),children:[e.jsx(Q,{value:"todos",children:"Todos"}),e.jsx(Q,{value:"efectivo",children:"Efectivo"}),e.jsx(Q,{value:"tarjeta",children:"Tarjeta"}),e.jsx(Q,{value:"devolucion",children:"Devolución"})]})]}),e.jsx(Z,{className:"btn-editar",onClick:()=>console.log("Exportar a Excel"),children:"Exportar a Excel"})]}),o?e.jsx("p",{children:"Cargando..."}):f?e.jsx("p",{className:"error-message",children:f}):b.length===0?e.jsx("p",{children:"No hay ventas registradas"}):e.jsx(Xe,{component:_e,children:e.jsxs(Pe,{children:[e.jsx(fe,{children:e.jsxs(te,{children:[e.jsx(A,{children:"ID Venta"}),e.jsx(A,{children:"Fecha"}),e.jsx(A,{children:"Nombre Usuario"}),e.jsx(A,{children:"Tipo Pago"}),e.jsx(A,{children:"Total Venta"}),e.jsx(A,{children:"Acciones"})]})}),e.jsx(ve,{children:b.map(a=>e.jsxs(te,{children:[e.jsx(A,{children:a.idVenta}),e.jsx(A,{children:ye(a.fechaVenta)}),e.jsx(A,{children:a.nombreUsuario}),e.jsx(A,{children:t(a.tipoPago)}),e.jsxs(A,{children:["$",s(parseFloat(a.totalVenta)||0)]}),e.jsxs(A,{children:[e.jsx(Z,{variant:"outlined",onClick:()=>L(a),children:"Detalle"}),e.jsx(Z,{variant:"outlined",onClick:()=>C(a),children:"Editar"})]})]},a.idVenta))})]})})]})}),x&&e.jsxs(ie,{open:x,onClose:$,children:[e.jsx(be,{children:"Editar Venta"}),e.jsx(Ne,{children:g&&e.jsxs("div",{children:[e.jsxs(je,{fullWidth:!0,margin:"normal",children:[e.jsx(pe,{id:"tipoPago-label",children:"Tipo de Pago"}),e.jsxs(ge,{labelId:"tipoPago-label",id:"tipoPago",name:"tipoPago",value:g.tipoPago,onChange:p,children:[e.jsx(Q,{value:"efectivo",children:"Efectivo"}),e.jsx(Q,{value:"tarjeta",children:"Tarjeta"}),e.jsx(Q,{value:"devolucion",children:"Devolución"})]})]}),e.jsx(re,{label:"Total Venta",name:"totalVenta",value:g.totalVenta,onChange:p,fullWidth:!0,margin:"normal"})]})}),e.jsxs(Se,{children:[e.jsx(Z,{onClick:$,children:"Cancelar"}),e.jsx(Z,{onClick:v,color:"primary",children:"Guardar"})]})]}),j&&e.jsxs(ie,{open:j,onClose:O,children:[e.jsx(be,{children:"Detalle de Venta"}),e.jsx(Ne,{children:y&&e.jsxs(Pe,{children:[e.jsx(fe,{children:e.jsxs(te,{children:[e.jsx(A,{children:"ID Producto"}),e.jsx(A,{children:"Nombre Producto"}),e.jsx(A,{children:"Cantidad"}),e.jsx(A,{children:"Precio"})]})}),e.jsx(ve,{children:y.productos.map(a=>e.jsxs(te,{children:[e.jsx(A,{children:a.idProducto}),e.jsx(A,{children:a.nombreProducto}),e.jsx(A,{children:a.cantidad}),e.jsxs(A,{children:["$",s(a.precio)]})]},a.idProducto))})]})}),e.jsx(Se,{children:e.jsx(Z,{onClick:O,children:"Cerrar"})})]})]})},la=()=>{const[P,m]=r.useState([]),[f,S]=r.useState({}),[o,d]=r.useState({}),[x,u]=r.useState({}),[j,N]=r.useState(0),[g,w]=r.useState(!0),[y,k]=r.useState(null),[T,E]=r.useState(new Date),[I,B]=r.useState("todos"),C=(c,V)=>V==="todos"?c:c.filter(b=>b.tipoPago===V),$=(c,V)=>{if(!V)return c;const b=Ye(new Date(V)),t=Qe(new Date(V));return c.filter(s=>s.fecha>=b&&s.fecha<=t)},L=(c,V)=>{const b={},t={},s={};let a=0;c.forEach(l=>{const{tipoPago:h,totalVenta:i,nombreUsuario:M,productos:z}=l;b[h]=(b[h]||0)+1,t[M]=(t[M]||0)+i,z.forEach(R=>{const{idProducto:F,cantidad:G}=R,me=V[F]||F;s[me]=(s[me]||0)+G}),a+=i}),S(b),d(t),u(s),N(a)};r.useEffect(()=>{(async()=>{try{const V=W(U,"sales"),b=W(U,"users"),t=W(U,"products"),[s,a,l]=await Promise.all([K(V),K(b),K(t)]),h={};a.forEach(R=>{h[R.id]=R.data().nombreUsuario});const i={};l.forEach(R=>{i[R.id]=R.data().nombreProducto});const M=s.docs.map(R=>{const F=R.data();let G;return F.fecha&&F.fecha.toDate?G=F.fecha.toDate():F.fecha&&F.fecha.toDate===void 0?G=new Date(F.fecha):G=new Date,{idVenta:R.id,...F,nombreUsuario:h[F.idUsuario]||"N/A",fecha:G}}),z=C($(M,T),I);L(z,i),m(z),w(!1)}catch(V){console.error("Error fetching data:",V),k("Ocurrió un error al cargar el historial de ventas"),w(!1)}})()},[T,I]);const O={labels:Object.keys(f),datasets:[{label:"Ventas por Tipo de Pago",data:Object.values(f),backgroundColor:["rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},p={labels:Object.keys(o),datasets:[{label:"Ventas por Usuario",data:Object.values(o),backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},n={labels:Object.keys(x),datasets:[{label:"Ventas por Producto",data:Object.values(x),backgroundColor:["rgba(54, 162, 235, 0.6)","rgba(255, 99, 132, 0.6)","rgba(75, 192, 192, 0.6)","rgba(255, 206, 86, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},v=c=>new Intl.NumberFormat("es-ES").format(c);return g?e.jsx("p",{children:"Loading..."}):y?e.jsxs("p",{children:["Error: ",y]}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"date-filter",children:[e.jsx("h3",{children:"Filtrar por Fecha"}),e.jsx(Ve,{dateAdapter:Ue,children:e.jsx(Te,{value:T,onChange:c=>E(c),renderInput:c=>e.jsx(re,{...c,style:{marginBottom:"16px"}})})})]}),e.jsx("div",{className:"metrics",children:e.jsxs("h2",{children:["Total Ventas: $",v(j.toFixed(0))]})}),e.jsxs("div",{className:"charts-container",children:[e.jsxs("div",{className:"pie-chart",children:[e.jsx("h3",{children:"Ventas por Tipo de Pago"}),e.jsx(Ze,{data:O})]}),e.jsxs("div",{className:"bar-charts",children:[e.jsxs("div",{className:"chart",children:[e.jsx("h3",{children:"Ventas por Usuario"}),e.jsx(Ce,{data:p})]}),e.jsxs("div",{className:"chart",children:[e.jsx("h3",{children:"Ventas por Producto"}),e.jsx(Ce,{data:n})]})]})]})]})]})},ua=()=>{const P=se(),[m,f]=ee.useState(!1),{signOut:S}=xe(),o=async()=>{try{await S(),P("/")}catch(u){console.error("Error al cerrar sesión:",u)}},d=()=>{f(!m)},x=()=>{f(!1)};return ee.useEffect(()=>{const u=()=>{window.innerWidth>=800&&x()};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[]),e.jsxs("nav",{className:"navbar",children:[e.jsxs("ul",{className:`sidebar ${m?"visible":""}`,children:[e.jsx("li",{onClick:x,children:e.jsx(D,{className:"menu",to:"#",children:e.jsx(H,{icon:Ie})})}),e.jsx("li",{children:e.jsx(D,{className:"link",to:"/vendedor/ventas",children:"Venta"})}),e.jsx("li",{children:e.jsx(D,{className:"link",to:"/vendedor/inventario",children:"Inventario"})}),e.jsx("li",{children:e.jsx(D,{className:"link",to:"/vendedor/devolucion",children:"Devolución"})}),e.jsx("li",{children:e.jsx(D,{className:"link",onClick:o,children:"Cerrar Sesion"})})]}),e.jsxs("ul",{children:[e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:"link",to:"/vendedor/inventario",children:"Inventario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:"link",to:"/vendedor/ventas",children:"Venta"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:"link",to:"/vendedor/devolucion",children:"Devolución"})}),e.jsx("li",{className:"Mobile",children:e.jsx(D,{className:"link",onClick:o,children:"Cerrar Sesion"})}),e.jsx("li",{onClick:d,children:e.jsx(D,{className:"menu",to:"#",children:e.jsx(H,{icon:Be})})})]})]})},ha=()=>{const{currentUser:P}=r.useContext(oe),[m,f]=r.useState([]),[S,o]=r.useState(""),[d,x]=r.useState([]),[u,j]=r.useState(!0),[N,g]=r.useState("efectivo"),[w,y]=r.useState(0),[k,T]=r.useState(0),[E,I]=r.useState(""),[B,C]=r.useState(1);r.useEffect(()=>{(async()=>{try{const a=(await K(W(U,"productos"))).docs.map(l=>({id:l.id,...l.data()}));f(a)}catch(s){o("Error al obtener los productos"),console.error("Error al obtener los productos:",s)}finally{j(!1)}})()},[P]),r.useEffect(()=>{if(E.length>0){const t=m.find(s=>String(s.id)===E);t?(L(t,B),I(""),C(1)):(o("Producto no encontrado."),setTimeout(()=>{o(""),I(""),C(1)},3e3))}},[E,m,B]);const $=t=>{I(t.target.value)},L=(t,s)=>{x(a=>{const l=a.find(h=>h.id===t.id);return l?l.cantidad+s<=t.cantidadProducto?a.map(h=>h.id===t.id?{...h,cantidad:h.cantidad+s}:h):(alert("Stock insuficiente"),a):t.cantidadProducto>=s?[...a,{...t,cantidad:s}]:(alert("Stock insuficiente"),a)})},O=t=>{x(s=>{var h;const a=s.find(i=>i.id===t),l=(h=m.find(i=>i.id===t))==null?void 0:h.cantidadProducto;return a&&l>a.cantidad?s.map(i=>i.id===t?{...i,cantidad:i.cantidad+1}:i):(alert("Stock insuficiente"),s)})},p=t=>{x(s=>s.map(a=>a.id===t?{...a,cantidad:Math.max(1,a.cantidad-1)}:a))},n=t=>{x(s=>s.filter(a=>a.id!==t))},v=t=>{g(t.target.value),t.target.value==="efectivo"&&(y(0),T(0))},c=t=>{const s=parseFloat(t.target.value);y(s);const a=d.reduce((l,h)=>l+h.precioProducto*h.cantidad,0);T(s-a)},V=async t=>{t.preventDefault();const s=new Date,a=d.reduce((i,M)=>i+M.precioProducto*M.cantidad,0),l=d.map(i=>({idProducto:i.id,nombreProducto:i.nombreProducto,marcaProducto:i.marcaProducto,categoriaProducto:i.categoriaProducto,precioProducto:i.precioProducto,cantidad:i.cantidad,cantidadProducto:i.cantidadProducto})),h=Y.currentUser;try{await de(W(U,"sales"),{fechaVenta:s,totalVenta:a,tipoPago:N,idUsuario:h.uid,productos:l});const i=le(U);d.forEach(M=>{const z=J(U,"productos",M.id);i.update(z,{cantidadProducto:M.cantidadProducto-M.cantidad})}),await i.commit(),x([]),alert("Venta registrada con éxito")}catch(i){o("Error al registrar la venta"),console.error("Error al registrar la venta:",i)}},b=t=>`${t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return u?e.jsx("div",{children:e.jsx("h1",{children:"Cargando productos..."})}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(ua,{})}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Carrito de compras"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:E,onChange:$,onBlur:()=>{if(E.length>0){const t=m.find(s=>String(s.id)===E);t?(L(t),I("")):o("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:B,min:"1",onChange:t=>{const s=parseInt(t.target.value);C(s<1?1:s)}})]}),S&&e.jsx("p",{className:"error",children:S}),e.jsx("section",{className:"tabla-ventas",children:e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"}),e.jsx("th",{className:"carrito-th",children:"Acciones"})]})}),e.jsx("tbody",{className:"carrito-items",children:d.map(t=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:t.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",b(t.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>p(t.idProducto),children:e.jsx(H,{icon:ue})}),t.cantidad,e.jsx("button",{className:"boton-suma",onClick:()=>O(t.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",b(t.precioProducto*t.cantidad)]})}),e.jsx("td",{className:"carrito-td",children:e.jsx("button",{className:"boton-eliminar",onClick:()=>n(t.idProducto),children:e.jsx(H,{icon:Me})})})]},t.idProducto))})]})}),e.jsxs("div",{className:"pago",children:[e.jsx("label",{htmlFor:"tipoPago",children:"Tipo de pago:"}),e.jsxs("select",{id:"tipoPago",value:N,onChange:v,className:"carrito-input",children:[e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"tarjeta",children:"Tarjeta"})]}),N==="efectivo"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cantidadEntregada",children:"Cantidad entregada:"}),e.jsx("input",{id:"cantidadEntregada",type:"number",value:w,onChange:c,className:"carrito-input"}),e.jsxs("p",{className:"textp",children:["Vuelto: $",b(k)]})]})]}),e.jsx("button",{className:"boton-venta",onClick:V,children:e.jsx("span",{children:"Finalizar Venta"})})]})})]})};function _({children:P,allowedRoles:m}){const{user:f,role:S}=xe();return f?m&&!m.includes(S)?e.jsx(ce,{to:"/unauthorized"}):P:e.jsx(ce,{to:"/login"})}function xa(){return e.jsxs(Ke,{children:[e.jsx(q,{path:"/",element:e.jsx(ce,{to:"/login"})}),e.jsx(q,{path:"/login",element:e.jsx(ta,{})}),e.jsx(q,{path:"/resetPassword",element:e.jsx(ra,{})}),e.jsx(q,{path:"/agregarUsuario",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(sa,{})})}),e.jsx(q,{path:"/agregarProducto",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(oa,{})})}),e.jsx(q,{path:"/dashboard",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(la,{})})}),e.jsx(q,{path:"/ventas",element:e.jsx(_,{allowedRoles:["admin","vendedor"],children:e.jsx(na,{})})}),e.jsx(q,{path:"/inventario",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(ca,{})})}),e.jsx(q,{path:"/devolucion",element:e.jsx(_,{allowedRoles:["admin","vendedor"],children:e.jsx(ia,{})})}),e.jsx(q,{path:"/historial",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(da,{})})}),e.jsx(q,{path:"/vendedor/ventas",element:e.jsx(_,{allowedRoles:["vendedor"],children:e.jsx(ha,{})})}),e.jsx(q,{path:"/unauthorized",element:e.jsx("div",{children:"Unauthorized - You do not have permission to view this page."})})]})}Le.createRoot(document.getElementById("root")).render(e.jsx(ee.StrictMode,{children:e.jsx(Ge,{children:e.jsx(aa,{children:e.jsx(xa,{})})})}));
