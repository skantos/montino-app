import{r,j as e,a as ee}from"./react-MB1aJdB0.js";import{c as Ae}from"./react-dom-babtui9j.js";import{g as Ee,s as Fe,a as De,b as $e,c as Re}from"./firebase-BOREzNWu.js";import{u as Oe,v as ze,w as qe,x as We,y as He,z as J,A as ne,B as we,D as K,G as W,H as de,I as le,J as ke}from"./@firebase-Bzy7ECXp.js";import{L as w,B as Ge}from"./react-router-dom-BP5qz8hL.js";import{a as se,b as Je,d as Ke,e as q,f as ce}from"./react-router-BDFDsiw1.js";import{T as re,B as Z,D as ie,L as Ve,A as Ue,a as Te,F as je,I as pe,S as ge,M as Q,b as Xe,P as _e,c as fe,d as Pe,e as te,f as L,g as ve,h as be,i as Ne,j as Se}from"./@mui-D6ajMDpQ.js";import{F as H,f as Ie,a as Be,b as ue,c as he,d as Me}from"./@fortawesome-CTlQ_N8p.js";import{f as Le,t as Ye,m as Qe}from"./date-fns-5tFtsWfW.js";import{P as Ze,B as Ce}from"./react-chartjs-2-BMTf87bo.js";import"./chart.js-C_W9Dm9B.js";import"./@babel-DdaQcUjw.js";import"./scheduler-CzFDRTuY.js";import"./tslib-BGVaTf34.js";import"./safevalues-NrgD-8pg.js";import"./idb-Bn1DMRyg.js";import"./@remix-run-BFLWy9pZ.js";import"./react-is-DcfIKM1A.js";import"./clsx-B-dksMZM.js";import"./@emotion-D2LlJvDI.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./prop-types-D-iIXjl8.js";import"./react-transition-group-DD9RWrmj.js";import"./dom-helpers-D0mFdbeO.js";import"./@popperjs-BQBsAJpH.js";import"./@kurkle-BZxJdD1U.js";(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))S(s);new MutationObserver(s=>{for(const d of s)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&S(h)}).observe(document,{childList:!0,subtree:!0});function v(s){const d={};return s.integrity&&(d.integrity=s.integrity),s.referrerPolicy&&(d.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?d.credentials="include":s.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function S(s){if(s.ep)return;s.ep=!0;const d=v(s);fetch(s.href,d)}})();const ea={apiKey:"AIzaSyAP7Af1h_-zBmBfL_A5K2uuJsJDFuOel0c",authDomain:"local-js-d7712.firebaseapp.com",databaseURL:"https://local-js-d7712-default-rtdb.firebaseio.com",projectId:"local-js-d7712",storageBucket:"local-js-d7712.appspot.com",messagingSenderId:"200538761653",appId:"1:200538761653:web:571a969ac8a572328451fc",measurementId:"G-XXD5WT5TV1"},ae=Oe(ea),Y=Ee(ae),T=ze(ae);qe(ae);We(ae);He(ae);const oe=r.createContext();function aa({children:P}){const[x,v]=r.useState(null),[S,s]=r.useState(null);r.useEffect(()=>{const u=Y.onAuthStateChanged(async j=>{if(j){v(j);const N=J(T,"users",j.uid),g=await ne(N);g.exists()?s(g.data().rolUsuario):s(null)}else v(null),s(null)});return()=>u()},[]);const d=async(u,j)=>{try{const N=await Fe(Y,u,j);v(N.user);const g=J(T,"users",N.user.uid),k=await ne(g);k.exists()?s(k.data().rolUsuario):s(null)}catch(N){throw console.error("Error signing in:",N),N}},h=async()=>{try{await De(Y),v(null),s(null)}catch(u){throw console.error("Error signing out:",u),u}};return e.jsx(oe.Provider,{value:{user:x,role:S,signIn:d,signOut:h},children:P})}function xe(){return r.useContext(oe)}function ta(){const[P,x]=r.useState(""),[v,S]=r.useState(""),[s,d]=r.useState(""),h=se(),{signIn:u,role:j}=xe(),N=async g=>{g.preventDefault(),d("");try{await u(P,v)}catch(k){d("Usuario o contraseña incorrectos"),console.error("Error al iniciar sesión:",k)}};return r.useEffect(()=>{j&&(j==="admin"?h("/ventas"):j==="vendedor"?h("/vendedor/ventas"):d("Rol de usuario no reconocido"))},[j,h]),e.jsx("div",{children:e.jsx("div",{className:"login-box",children:e.jsxs("form",{className:"form",onSubmit:N,children:[e.jsxs("p",{className:"form-title",children:["Los Tios ",e.jsx("br",{}),"Iniciar Sesión"]}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"email",placeholder:"Email",value:P,onChange:g=>x(g.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"password",placeholder:"Contraseña",value:v,onChange:g=>S(g.target.value),required:!0})}),s&&e.jsx("p",{className:"signup-link",children:s}),e.jsx("button",{type:"submit",className:"submit",children:"Ingresar"}),e.jsx("p",{className:"signup-link",children:e.jsx(w,{to:"/resetPassword",className:"resetPassword",children:"Olvidé mi Contraseña"})})]})})})}const ra=()=>{const[P,x]=r.useState(""),[v,S]=r.useState(!1),[s,d]=r.useState(null),h=se(),u=()=>{$e(Y,P).then(()=>{S(!0),setTimeout(()=>{h("/")},6e3)}).catch(j=>{d("No se pudo enviar el correo electrónico de restablecimiento de contraseña.")})};return e.jsxs("div",{className:"recuperar-contrasena",children:[e.jsx("h1",{children:"Recuperar Contraseña"}),v?e.jsx("p",{children:"Se ha enviado un correo electrónico con instrucciones para restablecer tu contraseña."}):e.jsxs(e.Fragment,{children:[e.jsx(re,{type:"email",label:"Correo Electrónico",value:P,onChange:j=>x(j.target.value),sx:{width:"16%"}}),e.jsx(Z,{onClick:u,variant:"outlined",sx:{fontSize:"19px",marginBottom:"19px",top:"10px"},children:"Enviar"}),s&&e.jsx("p",{style:{color:"red"},children:s})]})]})},X=()=>{const P=se(),x=Je(),[v,S]=ee.useState(!1),s=async()=>{const j=Ee();try{await De(j),localStorage.removeItem("token"),P("/")}catch(N){console.error("Error al cerrar sesión:",N)}},d=()=>{S(!v)},h=()=>{S(!1)};ee.useEffect(()=>{const j=()=>{window.innerWidth>=800&&h()};return window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}},[]);const u=j=>x.pathname===j?"active":"";return e.jsxs("nav",{className:"navbar",children:[e.jsxs("ul",{className:`sidebar ${v?"visible":""}`,children:[e.jsx("li",{onClick:h,children:e.jsx(w,{className:"menu",to:"#",children:e.jsx(H,{icon:Ie})})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/ventas")}`,to:"/ventas",children:"Venta"})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/agregarProducto")}`,to:"/agregarProducto",children:"Agregar Producto"})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/agregarUsuario")}`,to:"/agregarUsuario",children:"Agregar Usuario"})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/inventario")}`,to:"/inventario",children:"Inventario"})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/devolucion")}`,to:"/devolucion",children:"Devolución"})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/dashboard")}`,to:"/dashboard",children:"Dashboard"})}),e.jsx("li",{children:e.jsx(w,{className:`link ${u("/historial")}`,to:"/historial",children:"Historial"})}),e.jsx("li",{children:e.jsx(w,{className:"link",onClick:s,children:"Cerrar Sesión"})})]}),e.jsxs("ul",{children:[e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/dashboard")}`,to:"/dashboard",children:"Dashboard"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/agregarProducto")}`,to:"/agregarProducto",children:"Agregar Producto"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/agregarUsuario")}`,to:"/agregarUsuario",children:"Agregar Usuario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/devolucion")}`,to:"/devolucion",children:"Devolución"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/ventas")}`,to:"/ventas",children:"Venta"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/inventario")}`,to:"/inventario",children:"Inventario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:`link ${u("/historial")}`,to:"/historial",children:"Historial"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:"link",onClick:s,children:"Cerrar Sesión"})}),e.jsx("li",{onClick:d,children:e.jsx(w,{className:"menu",to:"#",children:e.jsx(H,{icon:Be})})})]})]})},sa=()=>{const[P,x]=r.useState(""),[v,S]=r.useState(""),[s,d]=r.useState(""),[h,u]=r.useState("vendedor"),[j,N]=r.useState(""),[g,k]=r.useState(""),E=async V=>{V.preventDefault(),console.log("Nombre de Usuario:",P),console.log("Email:",v),console.log("Contraseña:",s),console.log("Rol:",h);try{const D=(await Re(Y,v,s)).user;console.log("Usuario creado:",D),await we(J(T,"users",D.uid),{nombreUsuario:P,emailUsuario:v,rolUsuario:h}),k("Usuario registrado exitosamente"),x(""),S(""),d(""),u("vendedor")}catch(I){console.error("Error al registrar el usuario:",I),I.code==="auth/email-already-in-use"?N("El correo electrónico ya está en uso. Por favor, use otro."):I.code==="permission-denied"?N("Permiso denegado. Verifica las reglas de seguridad."):N("Error al registrar el usuario")}};return e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"login-box",children:[e.jsx("p",{className:"form-title",children:"Registrar Usuario"}),e.jsxs("form",{className:"form",onSubmit:E,children:[e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"text",placeholder:"Nombre de Usuario",value:P,onChange:V=>x(V.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"email",placeholder:"Email",value:v,onChange:V=>S(V.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsx("input",{type:"password",placeholder:"Contraseña",value:s,onChange:V=>d(V.target.value),required:!0})}),e.jsx("div",{className:"input-container",children:e.jsxs("select",{value:h,onChange:V=>u(V.target.value),required:!0,children:[e.jsx("option",{value:"vendedor",children:"Vendedor"}),e.jsx("option",{value:"admin",children:"Administrador"})]})}),j&&e.jsx("p",{className:"signup-link",children:j}),g&&e.jsx("p",{className:"signup-link",children:g}),e.jsx("button",{className:"submit",type:"submit",children:"Registrar Usuario"})]})]})]})},oa=()=>{const[P,x]=r.useState(""),[v,S]=r.useState(""),[s,d]=r.useState(""),[h,u]=r.useState(""),[j,N]=r.useState(""),[g,k]=r.useState(""),[E,V]=r.useState(""),[I,D]=r.useState(""),B=async()=>{try{const y=J(T,"productos",P);return(await ne(y)).exists()}catch(y){return console.error("Error checking product existence:",y),V("Error al verificar la existencia del producto"),!1}},M=async y=>{if(y.preventDefault(),await B()){V("El producto ya está registrado");return}try{const A=J(T,"productos",P);await we(A,{idProducto:P,nombreProducto:v,precioProducto:s,categoriaProducto:h,marcaProducto:j,cantidadProducto:g}),D("Producto registrado exitosamente"),x(""),S(""),d(""),u(""),N(""),k(""),V("")}catch(A){V("Hubo un error al registrar el producto"),console.error("Error al registrar el producto:",A)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("div",{children:e.jsxs("div",{className:"productos-box",children:[e.jsx("p",{className:"form-title",children:"Ingresar Producto"}),e.jsxs("form",{className:"form-producto",onSubmit:M,children:[e.jsxs("div",{className:"detalle",children:[e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Código Producto"}),e.jsx("input",{type:"text",placeholder:"Id Producto",value:P,onChange:y=>x(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Nombre producto"}),e.jsx("input",{type:"text",placeholder:"Nombre Producto",value:v,onChange:y=>S(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Precio Producto"}),e.jsx("input",{type:"text",placeholder:"Precio Producto",value:s,onChange:y=>d(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Categoria Producto"}),e.jsx("input",{type:"text",placeholder:"Categoria Producto",value:h,onChange:y=>u(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Marca Producto"}),e.jsx("input",{type:"text",placeholder:"Marca Producto",value:j,onChange:y=>N(y.target.value),required:!0})]}),e.jsxs("div",{className:"input-producto",children:[e.jsx("p",{children:"Cantidad Producto"}),e.jsx("input",{type:"text",placeholder:"Cantidad Producto",value:g,onChange:y=>k(y.target.value),required:!0})]})]}),E&&e.jsx("p",{className:"form-title",children:E}),I&&e.jsx("p",{className:"form-title",children:I}),e.jsx("button",{className:"submit",type:"submit",children:"Agregar Producto"})]})]})})]})},na=()=>{const{currentUser:P}=r.useContext(oe),[x,v]=r.useState([]),[S,s]=r.useState(""),[d,h]=r.useState([]),[u,j]=r.useState(!0),[N,g]=r.useState("efectivo"),[k,E]=r.useState(0),[V,I]=r.useState(0),[D,B]=r.useState(""),[M,y]=r.useState(1);r.useEffect(()=>{(async()=>{try{const i=(await K(W(T,"productos"))).docs.map(m=>({id:m.id,...m.data()}));v(i)}catch(a){s("Error al obtener los productos"),console.error("Error al obtener los productos:",a)}finally{j(!1)}})()},[P]),r.useEffect(()=>{if(D.length>0){const t=x.find(a=>String(a.id)===D);t?(A(t,M),B(""),y(1)):(s("Producto no encontrado."),setTimeout(()=>{s(""),B(""),y(1)},3e3))}},[D,x,M]);const R=t=>{B(t.target.value)},A=(t,a)=>{h(i=>{const m=i.find(l=>l.id===t.id);return m?m.cantidad+a<=t.cantidadProducto?i.map(l=>l.id===t.id?{...l,cantidad:l.cantidad+a}:l):(alert("Stock insuficiente"),i):t.cantidadProducto>=a?[...i,{...t,cantidad:a}]:(alert("Stock insuficiente"),i)})},z=t=>{h(a=>{var l;const i=a.find(C=>C.id===t),m=(l=x.find(C=>C.id===t))==null?void 0:l.cantidadProducto;return i&&m>i.cantidad?a.map(C=>C.id===t?{...C,cantidad:C.cantidad+1}:C):(alert("Stock insuficiente"),a)})},p=t=>{h(a=>a.map(i=>i.id===t?{...i,cantidad:Math.max(1,i.cantidad-1)}:i))},o=t=>{h(a=>a.filter(i=>i.id!==t))},b=t=>{g(t.target.value),t.target.value==="efectivo"&&(E(0),I(0))},n=t=>{const a=parseFloat(t.target.value);E(a);const i=d.reduce((m,l)=>m+l.precioProducto*l.cantidad,0);I(a-i)},U=async t=>{t.preventDefault();const a=new Date,i=d.reduce((C,F)=>C+F.precioProducto*F.cantidad,0),m=d.map(C=>({idProducto:C.id,nombreProducto:C.nombreProducto,marcaProducto:C.marcaProducto,categoriaProducto:C.categoriaProducto,precioProducto:C.precioProducto,cantidad:C.cantidad,cantidadProducto:C.cantidadProducto})),l=Y.currentUser;try{await de(W(T,"sales"),{fechaVenta:a,totalVenta:i,tipoPago:N,idUsuario:l.uid,productos:m});const C=le(T);d.forEach(F=>{const O=J(T,"productos",F.id);C.update(O,{cantidadProducto:F.cantidadProducto-F.cantidad})}),await C.commit(),h([]),alert("Venta registrada con éxito")}catch(C){s("Error al registrar la venta"),console.error("Error al registrar la venta:",C)}},f=t=>`${t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;d.reduce((t,a)=>t+a.cantidad,0);const c=d.reduce((t,a)=>t+a.precioProducto*a.cantidad,0);return u?e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("h1",{children:"Cargando productos..."})]}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Carrito de compras"}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:D,onChange:R,onBlur:()=>{if(D.length>0){const t=x.find(a=>String(a.id)===D);t?(A(t),B("")):s("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:M,min:"1",onChange:t=>{const a=parseInt(t.target.value);y(a<1?1:a)}})]}),e.jsx("label",{className:"textp",htmlFor:"tipoPago",children:"Tipo de pago:"}),e.jsxs("select",{id:"tipoPago",value:N,onChange:b,className:"carrito-input",children:[e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"tarjeta",children:"Tarjeta"})]}),S&&e.jsx("p",{className:"error",children:S}),e.jsx("section",{className:"tabla-ventas",children:e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"}),e.jsx("th",{className:"carrito-th",children:"Acciones"})]})}),e.jsx("tbody",{className:"carrito-items",children:d.map(t=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:t.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",f(t.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>p(t.idProducto),children:e.jsx(H,{icon:ue})}),t.cantidad,e.jsx("button",{className:"boton-suma",onClick:()=>z(t.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",f(t.precioProducto*t.cantidad)]})}),e.jsx("td",{className:"carrito-td",children:e.jsx("button",{className:"boton-eliminar",onClick:()=>o(t.idProducto),children:e.jsx(H,{icon:Me})})})]},t.idProducto))})]})}),e.jsxs("div",{className:"pago",children:[e.jsxs("p",{className:"textp",children:["Total monto: $",f(c)]}),N==="efectivo"&&e.jsxs("div",{children:[e.jsx("label",{className:"textp",htmlFor:"cantidadEntregada",children:"Cantidad entregada:"}),e.jsx("input",{id:"cantidadEntregada",type:"number",value:k,onChange:n,className:"carrito-input"}),e.jsxs("p",{className:"textp",children:["Vuelto: $",f(V)]})]})]}),e.jsx("button",{className:"boton-venta",onClick:U,children:e.jsx("span",{children:"Finalizar Venta"})})]})})]})},ca=()=>{const[P,x]=r.useState([]),[v,S]=r.useState(""),[s,d]=r.useState([]),[h,u]=r.useState(!0),[j,N]=r.useState(!1),[g,k]=r.useState(null),[E,V]=r.useState({idProducto:"",nombreProducto:"",precioProducto:"",categoriaProducto:"",marcaProducto:"",cantidadProducto:""});r.useEffect(()=>{(async()=>{try{const b=(await K(W(T,"productos"))).docs.map(n=>({idProducto:n.id,...n.data()}));x(b),d(b)}catch{S("Error al cargar los productos. Intente más tarde.")}finally{u(!1)}})()},[]);const I=p=>{const o=p.target.value.toLowerCase();if(o==="")d(P);else{const b=P.filter(n=>{const U=String(n.idProducto).toLowerCase(),f=String(n.nombreProducto).toLowerCase(),c=String(n.precioProducto).toLowerCase(),t=String(n.categoriaProducto).toLowerCase(),a=String(n.marcaProducto).toLowerCase(),i=String(n.cantidadProducto).toLowerCase();return U.includes(o)||f.includes(o)||c.includes(o)||t.includes(o)||a.includes(o)||i.includes(o)});d(b)}},D=p=>`${p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`,B=p=>{k(p),V({idProducto:p.idProducto,nombreProducto:p.nombreProducto,precioProducto:p.precioProducto,categoriaProducto:p.categoriaProducto,marcaProducto:p.marcaProducto,cantidadProducto:p.cantidadProducto}),N(!0)},M=p=>{const{name:o,value:b}=p.target;V({...E,[o]:b})},y=()=>{N(!1),k(null)},R=async p=>{p.preventDefault();try{const o=J(T,"productos",E.idProducto);await ke(o,{nombreProducto:E.nombreProducto,precioProducto:Number(E.precioProducto),categoriaProducto:E.categoriaProducto,marcaProducto:E.marcaProducto,cantidadProducto:Number(E.cantidadProducto)}),console.log("Productos antes de actualizar:",P),console.log("Inventario filtrado antes de actualizar:",s),x(b=>b.map(n=>n.idProducto===g.idProducto?{...n,...E}:n)),d(b=>b.map(n=>n.idProducto===g.idProducto?{...n,...E}:n)),console.log("Productos después de actualizar:",P),console.log("Inventario filtrado después de actualizar:",s),y()}catch(o){console.error("Error al actualizar el producto:",o)}},A=s.reduce((p,o)=>p+o.cantidadProducto,0),z=s.reduce((p,o)=>p+o.precioProducto*o.cantidadProducto,0);return h?e.jsx("p",{children:"Cargando productos..."}):v?e.jsx("p",{children:v}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"body-tabla",children:[e.jsxs("main",{className:"table",children:[e.jsxs("section",{className:"table-header",children:[e.jsxs("p",{className:"form-title",children:["Total del Inventario: $",D(z)]}),e.jsxs("p",{className:"form-title",children:["Total de productos: ",A]}),e.jsx("input",{className:"buscar",type:"text",placeholder:"Buscar producto",onChange:I})]}),e.jsx("section",{className:"table-body",children:e.jsxs("table",{className:"tabla-inventario",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Codigo"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Categoria"}),e.jsx("th",{children:"Marca"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:s.length>0?s.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.idProducto}),e.jsx("td",{children:p.nombreProducto}),e.jsx("td",{children:D(p.precioProducto)}),e.jsx("td",{children:p.categoriaProducto}),e.jsx("td",{children:p.marcaProducto}),e.jsx("td",{children:e.jsx("p",{className:p.cantidadProducto<=5?"cantidad-baja":p.cantidadProducto<=15?"cantidad-media":"cantidad-alta",children:p.cantidadProducto})}),e.jsx("td",{children:e.jsx("button",{className:"btn-editar",onClick:()=>B(p),children:"Editar"})})]},p.idProducto)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No hay productos disponibles"})})})]})})]}),e.jsx(ie,{open:j,onClose:y,children:g&&e.jsxs("div",{className:"formulario-editar",children:[e.jsx("p",{className:"form-title",children:"Editar Producto "}),e.jsxs("form",{onSubmit:R,children:[e.jsxs("label",{children:["Nombre:",e.jsx("input",{type:"text",name:"nombreProducto",value:E.nombreProducto,onChange:M})]}),e.jsxs("label",{children:["Precio:",e.jsx("input",{type:"number",name:"precioProducto",value:E.precioProducto,onChange:M})]}),e.jsxs("label",{children:["Categoria:",e.jsx("input",{type:"text",name:"categoriaProducto",value:E.categoriaProducto,onChange:M})]}),e.jsxs("label",{children:["Marca:",e.jsx("input",{type:"text",name:"marcaProducto",value:E.marcaProducto,onChange:M})]}),e.jsxs("label",{children:["Cantidad:",e.jsx("input",{type:"number",name:"cantidadProducto",value:E.cantidadProducto,onChange:M})]}),e.jsx("button",{type:"submit",children:"Actualizar Producto"}),e.jsx("button",{type:"button",onClick:y,children:"Cancelar"})]})]})})]})]})},ia=()=>{const[P,x]=r.useState([]),[v,S]=r.useState(""),[s,d]=r.useState([]),[h,u]=r.useState(!0);r.useState("efectivo");const[j,N]=r.useState(""),[g,k]=r.useState(1),[E,V]=r.useState(!1),[I,D]=r.useState(!1);r.useEffect(()=>{let o=!0;return(async()=>{try{const n=W(T,"productos"),f=(await K(n)).docs.map(c=>({id:c.id,...c.data()}));o&&x(f)}catch(n){S("Error al obtener los productos"),console.error("Error al obtener los productos:",n)}finally{o&&u(!1)}})(),()=>{o=!1}},[]),r.useEffect(()=>{if(j.length>0){const o=P.find(b=>String(b.idProducto)===j);o?(E?y(o,g):M(o,g),N(""),k(1)):(S("Producto no encontrado."),setTimeout(()=>{S(""),N(""),k(1)},3e3))}},[j,P,g,E]);const B=o=>{N(o.target.value)},M=(o,b)=>{d(n=>n.find(f=>f.idProducto===o.idProducto)?n.map(f=>f.idProducto===o.idProducto?{...f,cantidad:f.cantidad+b}:f):[...n,{...o,cantidad:b}])},y=(o,b)=>{d(n=>n.find(f=>f.idProducto===o.idProducto)?n.map(f=>f.idProducto===o.idProducto?{...f,cantidad:f.cantidad+b}:f):[...n,{...o,cantidad:b}])},R=o=>{d(b=>b.map(n=>n.idProducto===o?{...n,cantidad:n.cantidad+1}:n))},A=o=>{d(b=>b.map(n=>n.idProducto===o?{...n,cantidad:Math.max(1,n.cantidad-1)}:n))},z=async o=>{o.preventDefault(),D(!0);const b=new Date,n=Y.currentUser;try{const U=s.reduce((a,i)=>a+i.precioProducto*i.cantidad,0),f=s.map(a=>({idProducto:a.idProducto,nombreProducto:a.nombreProducto,marcaProducto:a.marcaProducto,categoriaProducto:a.categoriaProducto,precioProducto:a.precioProducto,cantidad:a.cantidad})),c=n?n.uid:"";await de(W(T,"sales"),{fechaVenta:b,totalVenta:-U,idUsuario:c,productos:f,tipoPago:"devolución"});const t=le(T);s.forEach(a=>{const i=J(T,"productos",a.idProducto),m=a.cantidadProducto+a.cantidad;t.update(i,{cantidadProducto:m})}),await t.commit(),d([]),N(""),k(1),D(!1),alert("Operación realizada con éxito")}catch(U){S("Error al registrar la operación"),console.error("Error al registrar la operación:",U),D(!1)}},p=o=>`${o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return h?e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("h1",{children:"Cargando productos..."})]}):e.jsxs("div",{children:[e.jsx(X,{}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Devolución"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:j,onChange:B,onBlur:()=>{if(j.length>0){const o=P.find(b=>String(b.idProducto)===j);o?(E?y(o,g):M(o,g),N("")):S("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:g,min:"1",onChange:o=>{const b=parseInt(o.target.value,10);k(b<1?1:b)}})]}),e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"})]})}),e.jsx("tbody",{className:"carrito-items",children:s.map(o=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:o.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["-$",p(o.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>A(o.idProducto),children:e.jsx(H,{icon:ue})}),e.jsx("span",{className:"spanCarrito",children:o.cantidad}),e.jsx("button",{className:"boton-suma",onClick:()=>R(o.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["-$",p(o.precioProducto*o.cantidad)]})})]},o.idProducto))})]}),e.jsx("div",{className:"venta-label",children:e.jsx("div",{className:"totalcarro",children:e.jsxs("p",{className:"textp",children:["Total a Devolver: -$",p(s.reduce((o,b)=>o+b.cantidad*b.precioProducto,0))]})})}),e.jsx("div",{className:"bottom-container",children:e.jsx("button",{className:"boton-venta",onClick:z,disabled:s.length===0,children:e.jsx("span",{children:"Devolución"})})})]})})]})},ye=P=>{const x=new Date(P.seconds*1e3);return Le(x,"dd/MM/yyyy")},da=()=>{const[P,x]=r.useState([]),[v,S]=r.useState(""),[s,d]=r.useState(!0),[h,u]=r.useState(!1),[j,N]=r.useState(!1),[g,k]=r.useState(null),[E,V]=r.useState(null),[I,D]=r.useState("todos"),[B,M]=r.useState(new Date);r.useEffect(()=>{(async()=>{try{const i=W(T,"sales"),m=W(T,"users"),[l,C]=await Promise.all([K(i),K(m)]),F={};C.forEach($=>{F[$.id]=$.data().nombreUsuario}),console.log("Users data:",F);const O=l.docs.map($=>{const G=$.data();return console.log("Venta data:",G),{idVenta:$.id,...G,nombreUsuario:F[G.idUsuario]||"N/A"}});console.log("Ventas data:",O),x(O),d(!1)}catch(i){console.error("Error fetching data:",i),S("Ocurrió un error al cargar el historial de ventas"),d(!1)}})()},[]);const y=a=>{k(a),u(!0)},R=()=>{u(!1),k(null)},A=a=>{V(a),N(!0)},z=()=>{N(!1),V(null)},p=a=>{const{name:i,value:m}=a.target;k(l=>({...l,[i]:m}))},o=a=>{M(a)},b=async()=>{try{const a=J(T,"sales",g.idVenta);await ke(a,{idUsuario:g.idUsuario,tipoPago:g.tipoPago,totalVenta:parseFloat(g.totalVenta)}),x(i=>i.map(m=>m.idVenta===g.idVenta?g:m)),R()}catch(a){console.error("Error updating sale:",a)}},f=((a,i)=>i==="todos"?a:a.filter(m=>m.tipoPago===i))(((a,i)=>{if(!i)return a;const m=Le(new Date(i),"dd/MM/yyyy");return a.filter(l=>ye(l.fechaVenta)===m)})(P,B),I),c=a=>{switch(a){case"efectivo":return"Efectivo";case"tarjeta":return"Tarjeta";case"devolucion":return"Devolución";default:return a}},t=a=>isNaN(a)?"0":`${a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsx("div",{className:"body-tabla",children:e.jsxs("main",{className:"table",children:[e.jsxs("section",{className:"table-header",children:[e.jsxs("p",{className:"form-title",children:["Total del día: $",t(f.reduce((a,i)=>a+(parseFloat(i.totalVenta)||0),0))]}),e.jsx(Ve,{dateAdapter:Ue,children:e.jsx(Te,{className:"fecha",label:"Selecciona una fecha",value:B,onChange:a=>o(a),renderInput:a=>e.jsx(re,{...a,style:{marginBottom:"16px"}})})}),e.jsxs(je,{className:"seleccionar-pago",children:[e.jsx(pe,{id:"tipoPago-label",children:"Tipo de Pago"}),e.jsxs(ge,{labelId:"tipoPago-label",id:"tipoPago",value:I,onChange:a=>D(a.target.value),children:[e.jsx(Q,{value:"todos",children:"Todos"}),e.jsx(Q,{value:"efectivo",children:"Efectivo"}),e.jsx(Q,{value:"tarjeta",children:"Tarjeta"}),e.jsx(Q,{value:"devolucion",children:"Devolución"})]})]}),e.jsx(Z,{className:"btn-editar",onClick:()=>console.log("Exportar a Excel"),children:"Exportar a Excel"})]}),s?e.jsx("p",{children:"Cargando..."}):v?e.jsx("p",{className:"error-message",children:v}):f.length===0?e.jsx("p",{children:"No hay ventas registradas"}):e.jsx(Xe,{component:_e,children:e.jsxs(fe,{children:[e.jsx(Pe,{children:e.jsxs(te,{children:[e.jsx(L,{children:"ID Venta"}),e.jsx(L,{children:"Fecha"}),e.jsx(L,{children:"Nombre Usuario"}),e.jsx(L,{children:"Tipo Pago"}),e.jsx(L,{children:"Total Venta"}),e.jsx(L,{children:"Acciones"})]})}),e.jsx(ve,{children:f.map(a=>e.jsxs(te,{children:[e.jsx(L,{children:a.idVenta}),e.jsx(L,{children:ye(a.fechaVenta)}),e.jsx(L,{children:a.nombreUsuario}),e.jsx(L,{children:c(a.tipoPago)}),e.jsxs(L,{children:["$",t(parseFloat(a.totalVenta)||0)]}),e.jsxs(L,{children:[e.jsx(Z,{variant:"outlined",onClick:()=>A(a),children:"Detalle"}),e.jsx(Z,{variant:"outlined",onClick:()=>y(a),children:"Editar"})]})]},a.idVenta))})]})})]})}),h&&e.jsxs(ie,{open:h,onClose:R,children:[e.jsx(be,{children:"Editar Venta"}),e.jsx(Ne,{children:g&&e.jsxs("div",{children:[e.jsxs(je,{fullWidth:!0,margin:"normal",children:[e.jsx(pe,{id:"tipoPago-label",children:"Tipo de Pago"}),e.jsxs(ge,{labelId:"tipoPago-label",id:"tipoPago",name:"tipoPago",value:g.tipoPago,onChange:p,children:[e.jsx(Q,{value:"efectivo",children:"Efectivo"}),e.jsx(Q,{value:"tarjeta",children:"Tarjeta"}),e.jsx(Q,{value:"devolucion",children:"Devolución"})]})]}),e.jsx(re,{label:"Total Venta",name:"totalVenta",value:g.totalVenta,onChange:p,fullWidth:!0,margin:"normal"})]})}),e.jsxs(Se,{children:[e.jsx(Z,{onClick:R,children:"Cancelar"}),e.jsx(Z,{onClick:b,color:"primary",children:"Guardar"})]})]}),j&&e.jsxs(ie,{open:j,onClose:z,children:[e.jsx(be,{children:"Detalle de Venta"}),e.jsx(Ne,{children:E&&e.jsxs(fe,{children:[e.jsx(Pe,{children:e.jsxs(te,{children:[e.jsx(L,{children:"ID Producto"}),e.jsx(L,{children:"Nombre Producto"}),e.jsx(L,{children:"Cantidad"}),e.jsx(L,{children:"Precio"})]})}),e.jsx(ve,{children:E.productos.map(a=>e.jsxs(te,{children:[e.jsx(L,{children:a.idProducto}),e.jsx(L,{children:a.nombreProducto}),e.jsx(L,{children:a.cantidad}),e.jsxs(L,{children:["$",t(a.precio)]})]},a.idProducto))})]})}),e.jsx(Se,{children:e.jsx(Z,{onClick:z,children:"Cerrar"})})]})]})},la=()=>{const[P,x]=r.useState([]),[v,S]=r.useState({}),[s,d]=r.useState({}),[h,u]=r.useState({}),[j,N]=r.useState(0),[g,k]=r.useState(!0),[E,V]=r.useState(null),[I,D]=r.useState(new Date),[B,M]=r.useState("todos"),y=(n,U)=>U==="todos"?n:n.filter(f=>f.tipoPago===U),R=(n,U)=>{if(!U)return n;const f=Ye(new Date(U)),c=Qe(new Date(U));return n.filter(t=>t.fecha>=f&&t.fecha<=c)},A=(n,U)=>{const f={},c={},t={};let a=0;n.forEach(i=>{const{tipoPago:m,totalVenta:l,nombreUsuario:C,productos:F}=i;f[m]=(f[m]||0)+1,c[C]=(c[C]||0)+l,F.forEach(O=>{const{idProducto:$,cantidad:G}=O,me=U[$]||$;t[me]=(t[me]||0)+G}),a+=l}),S(f),d(c),u(t),N(a)};r.useEffect(()=>{(async()=>{try{const U=W(T,"sales"),f=W(T,"users"),c=W(T,"products"),[t,a,i]=await Promise.all([K(U),K(f),K(c)]),m={};a.forEach(O=>{m[O.id]=O.data().nombreUsuario});const l={};i.forEach(O=>{l[O.id]=O.data().nombreProducto});const C=t.docs.map(O=>{const $=O.data();let G;return $.fecha&&$.fecha.toDate?G=$.fecha.toDate():$.fecha&&$.fecha.toDate===void 0?G=new Date($.fecha):G=new Date,{idVenta:O.id,...$,nombreUsuario:m[$.idUsuario]||"N/A",fecha:G}}),F=y(R(C,I),B);A(F,l),x(F),k(!1)}catch(U){console.error("Error fetching data:",U),V("Ocurrió un error al cargar el historial de ventas"),k(!1)}})()},[I,B]);const z={labels:Object.keys(v),datasets:[{label:"Ventas por Tipo de Pago",data:Object.values(v),backgroundColor:["rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},p={labels:Object.keys(s),datasets:[{label:"Ventas por Usuario",data:Object.values(s),backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},o={labels:Object.keys(h),datasets:[{label:"Ventas por Producto",data:Object.values(h),backgroundColor:["rgba(54, 162, 235, 0.6)","rgba(255, 99, 132, 0.6)","rgba(75, 192, 192, 0.6)","rgba(255, 206, 86, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"]}]},b=n=>new Intl.NumberFormat("es-ES").format(n);return g?e.jsx("p",{children:"Loading..."}):E?e.jsxs("p",{children:["Error: ",E]}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(X,{})}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"date-filter",children:[e.jsx("h3",{children:"Filtrar por Fecha"}),e.jsx(Ve,{dateAdapter:Ue,children:e.jsx(Te,{value:I,onChange:n=>D(n),renderInput:n=>e.jsx(re,{...n,style:{marginBottom:"16px"}})})})]}),e.jsx("div",{className:"metrics",children:e.jsxs("h2",{children:["Total Ventas: $",b(j.toFixed(0))]})}),e.jsxs("div",{className:"charts-container",children:[e.jsxs("div",{className:"pie-chart",children:[e.jsx("h3",{children:"Ventas por Tipo de Pago"}),e.jsx(Ze,{data:z})]}),e.jsxs("div",{className:"bar-charts",children:[e.jsxs("div",{className:"chart",children:[e.jsx("h3",{children:"Ventas por Usuario"}),e.jsx(Ce,{data:p})]}),e.jsxs("div",{className:"chart",children:[e.jsx("h3",{children:"Ventas por Producto"}),e.jsx(Ce,{data:o})]})]})]})]})]})},ua=()=>{const P=se(),[x,v]=ee.useState(!1),{signOut:S}=xe(),s=async()=>{try{await S(),P("/")}catch(u){console.error("Error al cerrar sesión:",u)}},d=()=>{v(!x)},h=()=>{v(!1)};return ee.useEffect(()=>{const u=()=>{window.innerWidth>=800&&h()};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[]),e.jsxs("nav",{className:"navbar",children:[e.jsxs("ul",{className:`sidebar ${x?"visible":""}`,children:[e.jsx("li",{onClick:h,children:e.jsx(w,{className:"menu",to:"#",children:e.jsx(H,{icon:Ie})})}),e.jsx("li",{children:e.jsx(w,{className:"link",to:"/vendedor/ventas",children:"Venta"})}),e.jsx("li",{children:e.jsx(w,{className:"link",to:"/vendedor/inventario",children:"Inventario"})}),e.jsx("li",{children:e.jsx(w,{className:"link",to:"/vendedor/devolucion",children:"Devolución"})}),e.jsx("li",{children:e.jsx(w,{className:"link",onClick:s,children:"Cerrar Sesion"})})]}),e.jsxs("ul",{children:[e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:"link",to:"/vendedor/inventario",children:"Inventario"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:"link",to:"/vendedor/ventas",children:"Venta"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:"link",to:"/vendedor/devolucion",children:"Devolución"})}),e.jsx("li",{className:"Mobile",children:e.jsx(w,{className:"link",onClick:s,children:"Cerrar Sesion"})}),e.jsx("li",{onClick:d,children:e.jsx(w,{className:"menu",to:"#",children:e.jsx(H,{icon:Be})})})]})]})},ha=()=>{const{currentUser:P}=r.useContext(oe),[x,v]=r.useState([]),[S,s]=r.useState(""),[d,h]=r.useState([]),[u,j]=r.useState(!0),[N,g]=r.useState("efectivo"),[k,E]=r.useState(0),[V,I]=r.useState(0),[D,B]=r.useState(""),[M,y]=r.useState(1);r.useEffect(()=>{(async()=>{try{const a=(await K(W(T,"productos"))).docs.map(i=>({id:i.id,...i.data()}));v(a)}catch(t){s("Error al obtener los productos"),console.error("Error al obtener los productos:",t)}finally{j(!1)}})()},[P]),r.useEffect(()=>{if(D.length>0){const c=x.find(t=>String(t.id)===D);c?(A(c,M),B(""),y(1)):(s("Producto no encontrado."),setTimeout(()=>{s(""),B(""),y(1)},3e3))}},[D,x,M]);const R=c=>{B(c.target.value)},A=(c,t)=>{h(a=>{const i=a.find(m=>m.id===c.id);return i?i.cantidad+t<=c.cantidadProducto?a.map(m=>m.id===c.id?{...m,cantidad:m.cantidad+t}:m):(alert("Stock insuficiente"),a):c.cantidadProducto>=t?[...a,{...c,cantidad:t}]:(alert("Stock insuficiente"),a)})},z=c=>{h(t=>{var m;const a=t.find(l=>l.id===c),i=(m=x.find(l=>l.id===c))==null?void 0:m.cantidadProducto;return a&&i>a.cantidad?t.map(l=>l.id===c?{...l,cantidad:l.cantidad+1}:l):(alert("Stock insuficiente"),t)})},p=c=>{h(t=>t.map(a=>a.id===c?{...a,cantidad:Math.max(1,a.cantidad-1)}:a))},o=c=>{h(t=>t.filter(a=>a.id!==c))},b=c=>{g(c.target.value),c.target.value==="efectivo"&&(E(0),I(0))},n=c=>{const t=parseFloat(c.target.value);E(t);const a=d.reduce((i,m)=>i+m.precioProducto*m.cantidad,0);I(t-a)},U=async c=>{c.preventDefault();const t=new Date,a=d.reduce((l,C)=>l+C.precioProducto*C.cantidad,0),i=d.map(l=>({idProducto:l.id,nombreProducto:l.nombreProducto,marcaProducto:l.marcaProducto,categoriaProducto:l.categoriaProducto,precioProducto:l.precioProducto,cantidad:l.cantidad,cantidadProducto:l.cantidadProducto})),m=Y.currentUser;try{await de(W(T,"sales"),{fechaVenta:t,totalVenta:a,tipoPago:N,idUsuario:m.uid,productos:i});const l=le(T);d.forEach(C=>{const F=J(T,"productos",C.id);l.update(F,{cantidadProducto:C.cantidadProducto-C.cantidad})}),await l.commit(),h([]),alert("Venta registrada con éxito")}catch(l){s("Error al registrar la venta"),console.error("Error al registrar la venta:",l)}},f=c=>`${c.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}`;return u?e.jsx("div",{children:e.jsx("h1",{children:"Cargando productos..."})}):e.jsxs("div",{children:[e.jsx("div",{className:"nav",children:e.jsx(ua,{})}),e.jsx("main",{className:"main1",children:e.jsxs("div",{className:"carrito-label",children:[e.jsx("p",{className:"form-title",children:"Carrito de compras"}),e.jsx("hr",{}),e.jsxs("div",{className:"encabezado",children:[e.jsx("input",{className:"carrito-input",type:"text",placeholder:"Buscar producto por ID...",value:D,onChange:R,onBlur:()=>{if(D.length>0){const c=x.find(t=>String(t.id)===D);c?(A(c),B("")):s("Producto no encontrado.")}}}),e.jsx("input",{className:"carrito-input",type:"number",placeholder:"Cantidad...",value:M,min:"1",onChange:c=>{const t=parseInt(c.target.value);y(t<1?1:t)}})]}),S&&e.jsx("p",{className:"error",children:S}),e.jsx("section",{className:"tabla-ventas",children:e.jsxs("table",{className:"carrito-tabla",children:[e.jsx("thead",{className:"carrito-th",children:e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("th",{className:"carrito-th",children:"Producto"}),e.jsx("th",{className:"carrito-th",children:"Precio"}),e.jsx("th",{className:"carrito-th",children:"Cantidad"}),e.jsx("th",{className:"carrito-th",children:"Total"}),e.jsx("th",{className:"carrito-th",children:"Acciones"})]})}),e.jsx("tbody",{className:"carrito-items",children:d.map(c=>e.jsxs("tr",{className:"carrito-tr",children:[e.jsx("td",{className:"carrito-td",children:e.jsx("p",{className:"txt-carrito",children:c.nombreProducto})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",f(c.precioProducto)]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:[e.jsx("button",{className:"boton-resta",onClick:()=>p(c.idProducto),children:e.jsx(H,{icon:ue})}),c.cantidad,e.jsx("button",{className:"boton-suma",onClick:()=>z(c.idProducto),children:e.jsx(H,{icon:he})})]})}),e.jsx("td",{className:"carrito-td",children:e.jsxs("p",{className:"txt-carrito",children:["$",f(c.precioProducto*c.cantidad)]})}),e.jsx("td",{className:"carrito-td",children:e.jsx("button",{className:"boton-eliminar",onClick:()=>o(c.idProducto),children:e.jsx(H,{icon:Me})})})]},c.idProducto))})]})}),e.jsxs("div",{className:"pago",children:[e.jsx("label",{htmlFor:"tipoPago",children:"Tipo de pago:"}),e.jsxs("select",{id:"tipoPago",value:N,onChange:b,className:"carrito-input",children:[e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"tarjeta",children:"Tarjeta"})]}),N==="efectivo"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cantidadEntregada",children:"Cantidad entregada:"}),e.jsx("input",{id:"cantidadEntregada",type:"number",value:k,onChange:n,className:"carrito-input"}),e.jsxs("p",{className:"textp",children:["Vuelto: $",f(V)]})]})]}),e.jsx("button",{className:"boton-venta",onClick:U,children:e.jsx("span",{children:"Finalizar Venta"})})]})})]})};function _({children:P,allowedRoles:x}){const{user:v,role:S}=xe();return v?x&&!x.includes(S)?e.jsx(ce,{to:"/unauthorized"}):P:e.jsx(ce,{to:"/login"})}function xa(){return e.jsxs(Ke,{children:[e.jsx(q,{path:"/",element:e.jsx(ce,{to:"/login"})}),e.jsx(q,{path:"/login",element:e.jsx(ta,{})}),e.jsx(q,{path:"/resetPassword",element:e.jsx(ra,{})}),e.jsx(q,{path:"/agregarUsuario",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(sa,{})})}),e.jsx(q,{path:"/agregarProducto",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(oa,{})})}),e.jsx(q,{path:"/dashboard",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(la,{})})}),e.jsx(q,{path:"/ventas",element:e.jsx(_,{allowedRoles:["admin","vendedor"],children:e.jsx(na,{})})}),e.jsx(q,{path:"/inventario",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(ca,{})})}),e.jsx(q,{path:"/devolucion",element:e.jsx(_,{allowedRoles:["admin","vendedor"],children:e.jsx(ia,{})})}),e.jsx(q,{path:"/historial",element:e.jsx(_,{allowedRoles:["admin"],children:e.jsx(da,{})})}),e.jsx(q,{path:"/vendedor/ventas",element:e.jsx(_,{allowedRoles:["vendedor"],children:e.jsx(ha,{})})}),e.jsx(q,{path:"/unauthorized",element:e.jsx("div",{children:"Unauthorized - You do not have permission to view this page."})})]})}Ae.createRoot(document.getElementById("root")).render(e.jsx(ee.StrictMode,{children:e.jsx(Ge,{children:e.jsx(aa,{children:e.jsx(xa,{})})})}));
